var PS={};(function(a){a.intAdd=function(a){return function(c){return a+c|0}};a.intMul=function(a){return function(c){return a*c|0}};a.refEq=function(a){return function(c){return a===c}};a.boolOr=function(a){return function(c){return a||c}};a.boolAnd=function(a){return function(c){return a&&c}};a.boolNot=function(a){return!a}})(PS.Prelude=PS.Prelude||{});
(function(a){var b=PS.Prelude,c=function(a){this.compose=a},d=function(a,b){this["__superclass_Prelude.Semigroupoid_0"]=a;this.id=b},e=function(a,b,c,s){this.add=a;this.mul=b;this.one=c;this.zero=s},f=function(a){this.eq=a},h=function(a,b){this.bottom=a;this.top=b},l=function(a,b,c,s){this["__superclass_Prelude.Bounded_0"]=a;this.conj=b;this.disj=c;this.not=s},k={},p=new e(b.intAdd,b.intMul,1,0),m=new c(function(a){return function(b){return function(c){return a(b(c))}}}),g=function(a){return a.pure},
q=new f(b.refEq),r=function(a){return function(b){return a}},s=new d(function(){return m},function(a){return a}),t=new h(!1,!0),b=new l(function(){return t},b.boolAnd,b.boolOr,b.boolNot),n=function(a){return a.bind},u=function(a){return a.apply};a.BooleanAlgebra=l;a.Bounded=h;a.Eq=f;a.Semiring=e;a.Semigroup=function(a){this.append=a};a.Monad=function(a,b){this["__superclass_Prelude.Applicative_0"]=a;this["__superclass_Prelude.Bind_1"]=b};a.Bind=function(a,b){this["__superclass_Prelude.Apply_0"]=a;
this.bind=b};a.Applicative=function(a,b){this["__superclass_Prelude.Apply_0"]=a;this.pure=b};a.Apply=function(a,b){this["__superclass_Prelude.Functor_0"]=a;this.apply=b};a.Functor=function(a){this.map=a};a.Category=d;a.Semigroupoid=c;a.not=function(a){return a.not};a.disj=function(a){return a.disj};a.conj=function(a){return a.conj};a.bottom=function(a){return a.bottom};a.top=function(a){return a.top};a["=="]=function(a){return a.eq};a.eq=function(a){return a.eq};a["+"]=function(a){return a.add};a.one=
function(a){return a.one};a.mul=function(a){return a.mul};a.zero=function(a){return a.zero};a.add=function(a){return a.add};a["<>"]=function(a){return a.append};a.append=function(a){return a.append};a.ap=function(a){return function(b){return function(c){return n(a["__superclass_Prelude.Bind_1"]())(b)(function(b){return n(a["__superclass_Prelude.Bind_1"]())(c)(function(c){return g(a["__superclass_Prelude.Applicative_0"]())(b(c))})})}}};a["return"]=g;a.bind=n;a.liftA1=function(a){return function(b){return function(c){return u(a["__superclass_Prelude.Apply_0"]())((0,a.pure)(b))(c)}}};
a.pure=function(a){return a.pure};a["<*>"]=u;a.apply=function(a){return a.apply};a["void"]=function(a){return function(b){return(0,a.map)(r(k))(b)}};a["<$>"]=function(a){return a.map};a.map=function(a){return a.map};a.id=function(a){return a.id};a["<<<"]=function(a){return a.compose};a.compose=function(a){return a.compose};a.otherwise=!0;a["const"]=r;a.flip=function(a){return function(b){return function(c){return a(c)(b)}}};a.unit=k;a.semigroupoidFn=m;a.categoryFn=s;a.semiringInt=p;a.eqBoolean=q;
a.boundedBoolean=t;a.booleanAlgebraBoolean=b})(PS.Prelude=PS.Prelude||{});(function(a){var b=PS.Prelude;a["*>"]=function(a){return function(d){return function(e){return b["<*>"](a)(b["<$>"](a["__superclass_Prelude.Functor_0"]())(b["const"](b.id(b.categoryFn)))(d))(e)}}}})(PS["Control.Apply"]=PS["Control.Apply"]||{});
(function(a){var b=function(a){return function(d){return(0,a.defer)(function(e){return d(b(a)(d))})}};a.Lazy=function(a){this.defer=a};a.fix=b;a.defer=function(a){return a.defer}})(PS["Control.Lazy"]=PS["Control.Lazy"]||{});(function(a){a.returnE=function(a){return function(){return a}};a.bindE=function(a){return function(c){return function(){return c(a())()}}};a.runPure=function(a){return a()}})(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{});
(function(a){var b=PS["Control.Monad.Eff"],c=PS.Prelude,d=new c.Monad(function(){return h},function(){return e}),e=new c.Bind(function(){return f},b.bindE),f=new c.Apply(function(){return l},c.ap(d)),h=new c.Applicative(function(){return f},b.returnE),l=new c.Functor(c.liftA1(h));a.functorEff=l;a.applyEff=f;a.applicativeEff=h;a.bindEff=e;a.monadEff=d;a.runPure=b.runPure})(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{});
(function(a){a.random=Math.random})(PS["Control.Monad.Eff.Random"]=PS["Control.Monad.Eff.Random"]||{});(function(a){a.toNumber=function(a){return a}})(PS["Data.Int"]=PS["Data.Int"]||{});(function(a){a.exp=Math.exp;a.pi=Math.PI})(PS.Math=PS.Math||{});(function(a){var b=PS.Math;a.pi=b.pi;a.exp=b.exp})(PS.Math=PS.Math||{});(function(a){a.unsafeThrow=function(a){throw Error(a);}})(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{});
(function(a){a.Monoid=function(a,c){this["__superclass_Prelude.Semigroup_0"]=a;this.mempty=c};a.mempty=function(a){return a.mempty}})(PS["Data.Monoid"]=PS["Data.Monoid"]||{});
(function(a){var b=PS.Prelude,c=function(){function a(){}a.value=new a;return a}(),d=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),b=new b.Functor(function(a){return function(b){return b instanceof d?new d(a(b.value0)):c.value}});a.Nothing=c;a.Just=d;a.functorMaybe=b})(PS["Data.Maybe"]=PS["Data.Maybe"]||{});
(function(a){var b=PS["Data.Maybe.Unsafe"],c=PS["Data.Maybe"];a.fromJust=function(a){if(a instanceof c.Just)return a.value0;if(a instanceof c.Nothing)return b.unsafeThrow("Data.Maybe.Unsafe.fromJust called on Nothing");throw Error("Failed pattern match at Data.Maybe.Unsafe line 10, column 1 - line 11, column 1: "+[a.constructor.name]);}})(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{});(function(a){a.toNumber=PS["Data.Int"].toNumber})(PS["Data.Int"]=PS["Data.Int"]||{});
(function(a){var b=PS["Control.Monad.Eff.Random"],c=PS.Prelude,d=PS["Control.Monad.Eff"];a.randomRange=function(a){return function(f){return function(){var h=b.random();return c["return"](d.applicativeEff)(h*(f-a)+a)()}}}})(PS["Control.Monad.Eff.Random"]=PS["Control.Monad.Eff.Random"]||{});
(function(a){a.newRef=function(a){return function(){return{value:a}}};a.readRef=function(a){return function(){return a.value}};a["modifyRef'"]=function(a){return function(c){return function(){var d=c(a.value);a.value=d.state;return d.value}}}})(PS["Control.Monad.Eff.Ref"]=PS["Control.Monad.Eff.Ref"]||{});
(function(a){var b=PS["Control.Monad.Eff.Ref"],c=PS.Prelude;a.modifyRef=function(a){return function(e){return b["modifyRef'"](a)(function(a){return{state:e(a),value:c.unit}})}};a.readRef=b.readRef;a.newRef=b.newRef})(PS["Control.Monad.Eff.Ref"]=PS["Control.Monad.Eff.Ref"]||{});(function(a){a.unsafeInterleaveEff=function(a){return a}})(PS["Control.Monad.Eff.Unsafe"]=PS["Control.Monad.Eff.Unsafe"]||{});
(function(a){a.unsafeInterleaveEff=PS["Control.Monad.Eff.Unsafe"].unsafeInterleaveEff})(PS["Control.Monad.Eff.Unsafe"]=PS["Control.Monad.Eff.Unsafe"]||{});(function(a){a.window=function(){return window}})(PS["DOM.HTML"]=PS["DOM.HTML"]||{});(function(a){a.window=PS["DOM.HTML"].window})(PS["DOM.HTML"]=PS["DOM.HTML"]||{});
(function(a){var b=null;a.requestAnimationFrame_=function(a){return function(d){b||(b=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||function(b){a.setTimeout(b,1E3/60)}}());return function(){return b(d)}}}})(PS["DOM.RequestAnimationFrame"]=PS["DOM.RequestAnimationFrame"]||{});
(function(a){var b=PS["DOM.RequestAnimationFrame"],c=PS["DOM.HTML"];a.requestAnimationFrame=function(a){return function(){var e=c.window();return b.requestAnimationFrame_(e)(a)()}}})(PS["DOM.RequestAnimationFrame"]=PS["DOM.RequestAnimationFrame"]||{});
(function(a){a.foldrArray=function(a){return function(c){return function(d){for(var e=c,f=d.length-1;0<=f;f--)e=a(d[f])(e);return e}}};a.foldlArray=function(a){return function(c){return function(d){for(var e=c,f=d.length,h=0;h<f;h++)e=a(e)(d[h]);return e}}}})(PS["Data.Foldable"]=PS["Data.Foldable"]||{});
(function(a){var b=PS.Prelude,c=PS["Data.Monoid"],d=function(a){return new b.Semigroup(function(c){return function(d){return b.disj(a)(c)(d)}})};a.Disj=function(a){return a};a.runDisj=function(a){return a};a.semigroupDisj=d;a.monoidDisj=function(a){return new c.Monoid(function(){return d(a)},b.bottom(a["__superclass_Prelude.Bounded_0"]()))}})(PS["Data.Monoid.Disj"]=PS["Data.Monoid.Disj"]||{});
(function(a){var b=PS["Data.Foldable"],c=PS.Prelude,d=PS["Data.Monoid"],e=PS["Control.Apply"],f=PS["Data.Monoid.Disj"],h=function(a,b,c){this.foldMap=a;this.foldl=b;this.foldr=c},l=function(a){return function(b){return function(d){return(0,b.foldr)(c["<<<"](c.semigroupoidFn)(e["*>"](a["__superclass_Prelude.Apply_0"]()))(d))(c.pure(a)(c.unit))}}},k=new h(function(a){return function(b){return function(f){return(0,k.foldr)(function(d){return function(f){return c["<>"](a["__superclass_Prelude.Semigroup_0"]())(b(d))(f)}})(d.mempty(a))(f)}}},
b.foldlArray,b.foldrArray);a.Foldable=h;a.any=function(a){return function(b){return function(d){return c["<<<"](c.semigroupoidFn)(f.runDisj)((0,a.foldMap)(f.monoidDisj(b))(c["<<<"](c.semigroupoidFn)(f.Disj)(d)))}}};a.for_=function(a){return function(b){return c.flip(l(a)(b))}};a.traverse_=l;a.foldMap=function(a){return a.foldMap};a.foldl=function(a){return a.foldl};a.foldr=function(a){return a.foldr};a.foldableArray=k})(PS["Data.Foldable"]=PS["Data.Foldable"]||{});
(function(a){a.defer=function(){function a(c){return this instanceof a?(this.thunk=c,this):new a(c)}a.prototype.force=function(){var a=this.thunk();delete this.thunk;this.force=function(){return a};return a};return a}();a.force=function(a){return a.force()}})(PS["Data.Lazy"]=PS["Data.Lazy"]||{});
(function(a){var b=PS["Data.Lazy"],c=new PS.Prelude.Functor(function(a){return function(c){return b.defer(function(f){return a(b.force(c))})}});a.functorLazy=c;a.force=b.force;a.defer=b.defer})(PS["Data.Lazy"]=PS["Data.Lazy"]||{});
(function(a){a.Traversable=function(a,c,d,e){this["__superclass_Data.Foldable.Foldable_1"]=a;this["__superclass_Prelude.Functor_0"]=c;this.sequence=d;this.traverse=e};a["for"]=function(a){return function(c){return function(d){return function(e){return(0,c.traverse)(a)(e)(d)}}}};a.sequence=function(a){return a.sequence};a.traverse=function(a){return a.traverse}})(PS["Data.Traversable"]=PS["Data.Traversable"]||{});
(function(a){var b=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(e){return new a(b,e)}};return a}();a.Tuple=b})(PS["Data.Tuple"]=PS["Data.Tuple"]||{});
(function(a){var b=PS.Prelude,c=PS["Data.Foldable"],d=PS["Data.Traversable"],e=PS["Data.Monoid"],f=function(){function a(){}a.value=new a;return a}(),h=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),l=function(a){return new h(a,f.value)},k=new b.Semigroup(function(a){return function(c){if(a instanceof f)return c;if(a instanceof h)return new h(a.value0,b["<>"](k)(a.value1)(c));throw Error("Failed pattern match: "+[a.constructor.name,
c.constructor.name]);}}),p=function(a){return function(c){if(a===c)return l(a);if(b.otherwise)return function(a){return function(c){return function(s){return function(f){var d=a,t=c,e=s,g=f;a:for(;;){if(d===t)return new h(d,g);if(b.otherwise){f=d+e|0;g=new h(d,g);d=f;continue a}throw Error("Failed pattern match at Data.List line 137, column 1 - line 138, column 1: "+[d.constructor.name,t.constructor.name,e.constructor.name,g.constructor.name]);}}}}}(c)(a)(function(){var b=a>c;if(b)return 1;if(!b)return-1;
throw Error("Failed pattern match at Data.List line 137, column 1 - line 138, column 1: "+[b.constructor.name]);}())(f.value);throw Error("Failed pattern match at Data.List line 137, column 1 - line 138, column 1: "+[a.constructor.name,c.constructor.name]);}},m=new b.Functor(function(a){return function(c){if(c instanceof f)return f.value;if(c instanceof h)return new h(a(c.value0),b["<$>"](m)(a)(c.value1));throw Error("Failed pattern match: "+[a.constructor.name,c.constructor.name]);}}),g=new c.Foldable(function(a){return function(d){return function(n){if(n instanceof
f)return e.mempty(a);if(n instanceof h)return b["<>"](a["__superclass_Prelude.Semigroup_0"]())(d(n.value0))(c.foldMap(g)(a)(d)(n.value1));throw Error("Failed pattern match: "+[d.constructor.name,n.constructor.name]);}}},function(a){return function(b){return function(d){if(d instanceof f)return b;if(d instanceof h)return c.foldl(g)(a)(a(b)(d.value0))(d.value1);throw Error("Failed pattern match: "+[a.constructor.name,b.constructor.name,d.constructor.name]);}}},function(a){return function(b){return function(d){if(d instanceof
f)return b;if(d instanceof h)return a(d.value0)(c.foldr(g)(a)(b)(d.value1));throw Error("Failed pattern match: "+[a.constructor.name,b.constructor.name,d.constructor.name]);}}}),q=new d.Traversable(function(){return g},function(){return m},function(a){return function(c){if(c instanceof f)return b.pure(a)(f.value);if(c instanceof h)return b["<*>"](a["__superclass_Prelude.Apply_0"]())(b["<$>"](a["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(h.create)(c.value0))(d.sequence(q)(a)(c.value1));
throw Error("Failed pattern match: "+[c.constructor.name]);}},function(a){return function(c){return function(e){if(e instanceof f)return b.pure(a)(f.value);if(e instanceof h)return b["<*>"](a["__superclass_Prelude.Apply_0"]())(b["<$>"](a["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(h.create)(c(e.value0)))(d.traverse(q)(a)(c)(e.value1));throw Error("Failed pattern match: "+[c.constructor.name,e.constructor.name]);}}}),r=new b.Apply(function(){return m},function(a){return function(c){if(a instanceof
f)return f.value;if(a instanceof h)return b["<>"](k)(b["<$>"](m)(a.value0)(c))(b["<*>"](r)(a.value1)(c));throw Error("Failed pattern match: "+[a.constructor.name,c.constructor.name]);}});a.Nil=f;a.Cons=h;a.range=p;a[".."]=p;a.singleton=l;a.toList=function(a){return c.foldr(a)(h.create)(f.value)};a.semigroupList=k;a.functorList=m;a.foldableList=g;a.traversableList=q;a.applyList=r})(PS["Data.List"]=PS["Data.List"]||{});
(function(a){var b=PS.Prelude,c=PS["Data.Lazy"],d=PS["Control.Lazy"],e=PS["Data.Maybe"],f=function(a){return a},h=function(){function a(){}a.value=new a;return a}(),l=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),k=function(a){return a},p=b["<<<"](b.semigroupoidFn)(c.force)(k),m=function(a){a=p(a);if(a instanceof h)return e.Nothing.value;if(a instanceof l)return new e.Just({head:a.value0,tail:a.value1});throw Error("Failed pattern match at Data.List.Lazy line 278, column 1 - line 279, column 1: "+
[a.constructor.name]);},g=new d.Lazy(function(a){return f(c.defer(b["<<<"](b.semigroupoidFn)(p)(a)))}),q=new b.Functor(function(a){return function(d){return b["<$>"](c.functorLazy)(function(c){if(c instanceof h)return h.value;if(c instanceof l)return new l(a(c.value0),b["<$>"](q)(a)(c.value1));throw Error("Failed pattern match at Data.List.Lazy line 671, column 5 - line 672, column 5: "+[c.constructor.name]);})(d)}}),r=function(a){return function(b){return f(c.defer(function(c){return new l(a,b)}))}};
a.Nil=h;a.Cons=l;a.List=f;a.uncons=m;a.tail=function(a){return b["<$>"](e.functorMaybe)(function(a){return a.tail})(m(a))};a.head=function(a){return b["<$>"](e.functorMaybe)(function(a){return a.head})(m(a))};a.cons=r;a.iterate=function(a){return function(c){return d.fix(g)(function(d){return r(c)(b["<$>"](q)(a)(d))})}};a.step=p;a.runList=k;a.lazyList=g;a.functorList=q})(PS["Data.List.Lazy"]=PS["Data.List.Lazy"]||{});
(function(a){a.getCanvasElementByIdImpl=function(a,c,d){return function(){var e=document.getElementById(a);return e&&e instanceof HTMLCanvasElement?c(e):d}};a.getContext2D=function(a){return function(){return a.getContext("2d")}};a.setLineWidth=function(a){return function(c){return function(){c.lineWidth=a;return c}}};a.setFillStyle=function(a){return function(c){return function(){c.fillStyle=a;return c}}};a.setStrokeStyle=function(a){return function(c){return function(){c.strokeStyle=a;return c}}};
a.beginPath=function(a){return function(){a.beginPath();return a}};a.stroke=function(a){return function(){a.stroke();return a}};a.fill=function(a){return function(){a.fill();return a}};a.lineTo=function(a){return function(c){return function(d){return function(){a.lineTo(c,d);return a}}}};a.moveTo=function(a){return function(c){return function(d){return function(){a.moveTo(c,d);return a}}}};a.closePath=function(a){return function(){a.closePath();return a}};a.arc=function(a){return function(c){return function(){a.arc(c.x,
c.y,c.r,c.start,c.end);return a}}};a.fillRect=function(a){return function(c){return function(){a.fillRect(c.x,c.y,c.w,c.h);return a}}};a.strokeRect=function(a){return function(c){return function(){a.strokeRect(c.x,c.y,c.w,c.h);return a}}};a.scale=function(a){return function(c){return function(){c.scale(a.scaleX,a.scaleY);return c}}};a.translate=function(a){return function(c){return function(){c.translate(a.translateX,a.translateY);return c}}}})(PS["Graphics.Canvas"]=PS["Graphics.Canvas"]||{});
(function(a){var b=PS["Graphics.Canvas"],c=PS.Prelude,d=PS["Data.Maybe"],e=PS["Control.Monad.Eff"];a.fillPath=function(a){return function(d){return function(){b.beginPath(a)();var l=d();b.fill(a)();return c["return"](e.applicativeEff)(l)()}}};a.strokePath=function(a){return function(d){return function(){b.beginPath(a)();var l=d();b.stroke(a)();return c["return"](e.applicativeEff)(l)()}}};a.getCanvasElementById=function(a){return b.getCanvasElementByIdImpl(a,d.Just.create,d.Nothing.value)};a.translate=
b.translate;a.scale=b.scale;a.strokeRect=b.strokeRect;a.fillRect=b.fillRect;a.arc=b.arc;a.closePath=b.closePath;a.moveTo=b.moveTo;a.lineTo=b.lineTo;a.stroke=b.stroke;a.beginPath=b.beginPath;a.setStrokeStyle=b.setStrokeStyle;a.setFillStyle=b.setFillStyle;a.setLineWidth=b.setLineWidth;a.getContext2D=b.getContext2D})(PS["Graphics.Canvas"]=PS["Graphics.Canvas"]||{});
(function(a){a.onSpaceBar=function(a){return function(){window.addEventListener("keydown",function(c){32===c.keyCode&&a(!0)()},!1);window.addEventListener("keyup",function(c){32===c.keyCode&&a(!1)()},!1)}}})(PS.Main=PS.Main||{});
(function(a){var b=PS.Main,c=PS.Prelude,d=PS.Math,e=PS["Data.Int"],f=PS["Control.Monad.Eff"],h=PS["Control.Monad.Eff.Unsafe"],l=PS["Data.Traversable"],k=PS["Data.List"],p=PS["Control.Monad.Eff.Random"],m=PS["Data.List.Lazy"],g=PS["Graphics.Canvas"],q=PS["Control.Monad.Eff.Ref"],r=PS["Data.Maybe.Unsafe"],s=PS["Data.Foldable"],t=PS["DOM.RequestAnimationFrame"],n=PS["Data.Maybe"],u=PS["Data.Tuple"],w=function(){function a(){}a.value=new a;return a}(),x=function(){function a(){}a.value=new a;return a}(),
y=function(){function a(c){this.value0=c}a.create=function(c){return new a(c)};return a}(),z=function(){function a(c){this.value0=c}a.create=function(c){return new a(c)};return a}(),A=function(a){return function(c){return{x:a.x-c.x,y:a.y-c.y}}},C=function(a){return a.x*a.x+a.y*a.y},D=new c.Eq(function(a){return function(c){return a instanceof w&&c instanceof w||a instanceof x&&c instanceof x?!0:!1}}),E=function(a){return function(c){return C(A(c)(a))}},v=function(a){return function(c){return function(b){return(1-
d.exp(-e.toNumber(b)/2.5))*(c-a)+a}}},B=function(a){return c["<<<"](c.semigroupoidFn)(f.runPure)(h.unsafeInterleaveEff)(function(){var b=v(0.0018)(0.0025)(a),d=v(0.005)(0.02)(a),g=v(0.13999999999999999)(0.04)(a);return function(){var a=l["for"](f.applicativeEff)(k.traversableList)(c["<*>"](k.applyList)(c["<$>"](k.functorList)(u.Tuple.create)(k[".."](0)(8)))(k[".."](2)(6)))(function(a){return function(){var b=p.randomRange(-0.025)(0.025)(),g=p.randomRange(-0.025)(0.025)();return c["return"](f.applicativeEff)({x:0.15+
0.7*e.toNumber(a.value0)/8+b,y:0.15+0.7*e.toNumber(a.value1)/8+g,r:d})()}})();return c["return"](f.applicativeEff)({stars:a,door:g,speed:b})()}}())},F=c["<$>"](m.functorList)(B)(m.iterate(c["+"](c.semiringInt)(1))(0));a.Playing=y;a.Waiting=z;a.Up=w;a.Down=x;a.main=function(){var a=g.getCanvasElementById("canvas")();if(a instanceof n.Just){var e=g.getContext2D(a.value0)(),h=q.newRef({space:!1})();b.onSpaceBar(function(a){return q.modifyRef(h)(function(c){var b={},d;for(d in c)c.hasOwnProperty(d)&&
(b[d]=c[d]);b.space=a;return b})})();g.translate({translateX:0,translateY:-170})(e)();g.scale({scaleX:800,scaleY:800})(e)();g.setLineWidth(0.001)(e)();var l=function(a){return function(b){if(b instanceof k.Cons&&b.value1 instanceof k.Cons){if(0.25>=b.value0.y||0.75<=b.value0.y||0.95<b.value0.x&&(b.value0.y<0.5-a.door/2||b.value0.y>0.5+a.door/2)||s.any(k.foldableList)(c.booleanAlgebraBoolean)(function(a){return E(b.value0)(a)<a.r*a.r})(a.stars))return!0;if(c.otherwise)return!1}throw Error("Failed pattern match at Main line 201, column 7 - line 202, column 7: "+
[a.constructor.name,b.constructor.name]);}},p=function(a){return function(){g.setStrokeStyle("lightgreen")(e)();return a instanceof k.Cons?c["void"](f.functorEff)(function(){g.beginPath(e)();g.moveTo(e)(a.value0.x)(a.value0.y)();s.for_(f.applicativeEff)(k.foldableList)(a.value1)(function(a){return g.lineTo(e)(a.x)(a.y)})();return g.stroke(e)()})():c["return"](f.applicativeEff)(c.unit)()}},u=function(a){return function(c){return function(b){if(b.space)b=w.value;else{if(b.space)throw Error("Failed pattern match at Main line 103, column 1 - line 215, column 28: "+
[b.space.constructor.name]);b=x.value}return new y({path:a,level:c,direction:b})}}},v=function(a){return function(b){return function(d){if(b.x>=0.95-a.speed&&b.y>=0.5-a.door/2&&b.y<=0.5+a.door/2)return n.Nothing.value;if(c.otherwise){if(d)d=1;else{if(d)throw Error("Failed pattern match at Main line 157, column 17 - line 158, column 13: "+[d.constructor.name]);d=-1}return new n.Just({x:b.x+a.speed,y:b.y+d*a.speed})}throw Error("Failed pattern match at Main line 103, column 1 - line 215, column 28: "+
[a.constructor.name,b.constructor.name,d.constructor.name]);}}},A=function(a){return new z({path:k.Nil.value,nextLevel:a})},C=function(a){return function(b){if(b instanceof y&&b.value0.path instanceof k.Cons){if(l(r.fromJust(m.head(b.value0.level)))(b.value0.path))return new z({path:b.value0.path,nextLevel:b.value0.level});if(c["=="](c.eqBoolean)(c["=="](D)(b.value0.direction)(w.value))(a.space)){var d=v(r.fromJust(m.head(b.value0.level)))(b.value0.path.value0)(a.space);if(d instanceof n.Just)return u(new k.Cons(d.value0,
b.value0.path.value1))(b.value0.level)(a);if(d instanceof n.Nothing)return A(r.fromJust(m.tail(b.value0.level)));throw Error("Failed pattern match at Main line 103, column 1 - line 215, column 28: "+[d.constructor.name]);}if(c.otherwise)return u(new k.Cons(b.value0.path.value0,new k.Cons(b.value0.path.value0,b.value0.path.value1)))(b.value0.level)(a)}if(b instanceof z){if(a.space)return b=b.value0.nextLevel,d={x:0.05,y:0.5},new y({path:k.toList(s.foldableArray)([d,d]),direction:x.value,level:b});
if(!a.space)return b;throw Error("Failed pattern match at Main line 103, column 1 - line 215, column 28: "+[a.space.constructor.name]);}throw Error("Failed pattern match at Main line 103, column 1 - line 215, column 28: "+[a.constructor.name,b.constructor.name]);}},B=function(a){return c["void"](f.functorEff)(function(){var b=r.fromJust(m.head(a));return function(){g.setFillStyle("black")(e)();g.fillRect(e)({x:0,y:0,w:1,h:1})();g.setStrokeStyle("lightgreen")(e)();g.strokeRect(e)({x:0.05,y:0.25,w:0.9,
h:0.5})();g.strokeRect(e)({x:0.045,y:0.24500000000000002,w:0.9099999999999999,h:0.51})();g.setFillStyle("lightgreen")(e)();g.fillRect(e)({x:0.045,y:0.5-b.door/2,w:0.005,h:b.door})();g.fillRect(e)({x:0.95,y:0.5-b.door/2,w:0.005,h:b.door})();g.setFillStyle("#222")(e)();g.setStrokeStyle("lightgreen")(e)();return s.for_(f.applicativeEff)(k.foldableList)(b.stars)(function(a){var b=function(){g.arc(e)({x:a.x,y:a.y,r:a.r,start:0,end:2*d.pi})();return g.closePath(e)()};return function(){g.fillPath(e)(b)();
return g.strokePath(e)(b)()}})()}}())},H=function(a){if(a instanceof z)return c["void"](f.functorEff)(function(){B(a.value0.nextLevel)();return p(a.value0.path)()});if(a instanceof y)return c["void"](f.functorEff)(function(){B(a.value0.level)();return p(a.value0.path)()});throw Error("Failed pattern match at Main line 103, column 1 - line 215, column 28: "+[a.constructor.name]);},G=function(a){return function(){H(a)();var b=q.readRef(h)();return t.requestAnimationFrame(G(C(b)(a)))()}};return G(A(F))()}throw Error("Failed pattern match at Main line 103, column 1 - line 215, column 28: "+
[a.constructor.name]);};a.levels=F;a.unsafeLevel=B;a.decay=v;a.subtract=A;a.len2=C;a.dist2=E;a.eqDirection=D;a.onSpaceBar=b.onSpaceBar})(PS.Main=PS.Main||{});
