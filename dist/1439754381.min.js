var PS={};(function(a){a.intAdd=function(a){return function(b){return a+b|0}};a.intMul=function(a){return function(b){return a*b|0}};a.refEq=function(a){return function(b){return a===b}};a.unsafeCompareImpl=function(a){return function(b){return function(d){return function(e){return function(f){return e<f?a:e>f?d:b}}}}};a.boolOr=function(a){return function(b){return a||b}};a.boolAnd=function(a){return function(b){return a&&b}};a.boolNot=function(a){return!a}})(PS.Prelude=PS.Prelude||{});
(function(a){var c=PS.Prelude,b=function(){function a(){}a.value=new a;return a}(),d=function(){function a(){}a.value=new a;return a}(),e=function(){function a(){}a.value=new a;return a}(),f=function(a){this.compose=a},g=function(a,c){this["__superclass_Prelude.Semigroupoid_0"]=a;this.id=c},l=function(a,c,b,s){this.add=a;this.mul=c;this.one=b;this.zero=s},k=function(a){this.eq=a},n=function(a,c){this["__superclass_Prelude.Eq_0"]=a;this.compare=c},m=function(a,c){this.bottom=a;this.top=c},h=function(a,
c,b,s){this["__superclass_Prelude.Bounded_0"]=a;this.conj=c;this.disj=b;this.not=s},p=c.unsafeCompareImpl(b.value)(e.value)(d.value),q={},s=new l(c.intAdd,c.intMul,1,0),u=new f(function(a){return function(c){return function(b){return a(c(b))}}}),t=function(a){return a.pure},E=new k(c.refEq),r=new n(function(){return E},p),B=new k(c.refEq),F=function(a){return function(c){return a}},y=new g(function(){return u},function(a){return a}),w=new m(!1,!0),c=new h(function(){return w},c.boolAnd,c.boolOr,c.boolNot),
v=function(a){return a.bind},x=function(a){return a.apply};a.LT=b;a.GT=d;a.EQ=e;a.BooleanAlgebra=h;a.Bounded=m;a.Ord=n;a.Eq=k;a.Ring=function(a,c){this["__superclass_Prelude.Semiring_0"]=a;this.sub=c};a.Semiring=l;a.Semigroup=function(a){this.append=a};a.Monad=function(a,c){this["__superclass_Prelude.Applicative_0"]=a;this["__superclass_Prelude.Bind_1"]=c};a.Bind=function(a,c){this["__superclass_Prelude.Apply_0"]=a;this.bind=c};a.Applicative=function(a,c){this["__superclass_Prelude.Apply_0"]=a;this.pure=
c};a.Apply=function(a,c){this["__superclass_Prelude.Functor_0"]=a;this.apply=c};a.Functor=function(a){this.map=a};a.Category=g;a.Semigroupoid=f;a.not=function(a){return a.not};a.disj=function(a){return a.disj};a.conj=function(a){return a.conj};a.bottom=function(a){return a.bottom};a.top=function(a){return a.top};a.unsafeCompare=p;a[">"]=function(a){return function(c){return function(b){return(0,a.compare)(c)(b)instanceof d?!0:!1}}};a.compare=function(a){return a.compare};a["=="]=function(a){return a.eq};
a.eq=function(a){return a.eq};a["-"]=function(a){return a.sub};a.sub=function(a){return a.sub};a["+"]=function(a){return a.add};a.one=function(a){return a.one};a.mul=function(a){return a.mul};a.zero=function(a){return a.zero};a.add=function(a){return a.add};a["<>"]=function(a){return a.append};a.append=function(a){return a.append};a.ap=function(a){return function(c){return function(b){return v(a["__superclass_Prelude.Bind_1"]())(c)(function(c){return v(a["__superclass_Prelude.Bind_1"]())(b)(function(b){return t(a["__superclass_Prelude.Applicative_0"]())(c(b))})})}}};
a["return"]=t;a.bind=v;a.liftA1=function(a){return function(c){return function(b){return x(a["__superclass_Prelude.Apply_0"]())((0,a.pure)(c))(b)}}};a.pure=function(a){return a.pure};a["<*>"]=x;a.apply=function(a){return a.apply};a["void"]=function(a){return function(c){return(0,a.map)(F(q))(c)}};a["<$>"]=function(a){return a.map};a.map=function(a){return a.map};a.id=function(a){return a.id};a["<<<"]=function(a){return a.compose};a.compose=function(a){return a.compose};a.otherwise=!0;a["const"]=F;
a.flip=function(a){return function(c){return function(b){return a(b)(c)}}};a.unit=q;a.semigroupoidFn=u;a.categoryFn=y;a.semiringInt=s;a.eqBoolean=B;a.eqNumber=E;a.ordNumber=r;a.boundedBoolean=w;a.booleanAlgebraBoolean=c})(PS.Prelude=PS.Prelude||{});(function(a){a.Alt=function(a,b){this["__superclass_Prelude.Functor_0"]=a;this.alt=b};a.alt=function(a){return a.alt}})(PS["Control.Alt"]=PS["Control.Alt"]||{});
(function(a){var c=function(a){return function(d){return(0,a.defer)(function(e){return d(c(a)(d))})}};a.Lazy=function(a){this.defer=a};a.fix=c;a.defer=function(a){return a.defer}})(PS["Control.Lazy"]=PS["Control.Lazy"]||{});(function(a){a.Plus=function(a,b){this["__superclass_Control.Alt.Alt_0"]=a;this.empty=b};a.empty=function(a){return a.empty}})(PS["Control.Plus"]=PS["Control.Plus"]||{});
(function(a){a.Alternative=function(a,b){this["__superclass_Control.Plus.Plus_1"]=a;this["__superclass_Prelude.Applicative_0"]=b}})(PS["Control.Alternative"]=PS["Control.Alternative"]||{});(function(a){var c=PS.Prelude;a["*>"]=function(a){return function(d){return function(e){return c["<*>"](a)(c["<$>"](a["__superclass_Prelude.Functor_0"]())(c["const"](c.id(c.categoryFn)))(d))(e)}}}})(PS["Control.Apply"]=PS["Control.Apply"]||{});
(function(a){a.returnE=function(a){return function(){return a}};a.bindE=function(a){return function(b){return function(){return b(a())()}}};a.runPure=function(a){return a()}})(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{});
(function(a){var c=PS["Control.Monad.Eff"],b=PS.Prelude,d=new b.Monad(function(){return g},function(){return e}),e=new b.Bind(function(){return f},c.bindE),f=new b.Apply(function(){return l},b.ap(d)),g=new b.Applicative(function(){return f},c.returnE),l=new b.Functor(b.liftA1(g));a.functorEff=l;a.applyEff=f;a.applicativeEff=g;a.bindEff=e;a.monadEff=d;a.runPure=c.runPure})(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{});
(function(a){a.random=Math.random})(PS["Control.Monad.Eff.Random"]=PS["Control.Monad.Eff.Random"]||{});(function(a){a.toNumber=function(a){return a}})(PS["Data.Int"]=PS["Data.Int"]||{});(function(a){a.exp=Math.exp;a.pi=Math.PI})(PS.Math=PS.Math||{});(function(a){var c=PS.Math;a.pi=c.pi;a.exp=c.exp})(PS.Math=PS.Math||{});(function(a){a.unsafeThrow=function(a){throw Error(a);}})(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{});
(function(a){var c=PS.Prelude,b=PS["Control.Plus"];a.MonadPlus=function(a,c){this["__superclass_Control.Alternative.Alternative_1"]=a;this["__superclass_Prelude.Monad_0"]=c};a.guard=function(a){return function(e){if(e)return c["return"](a["__superclass_Control.Alternative.Alternative_1"]()["__superclass_Prelude.Applicative_0"]())(c.unit);if(!e)return b.empty(a["__superclass_Control.Alternative.Alternative_1"]()["__superclass_Control.Plus.Plus_1"]());throw Error("Failed pattern match at Control.MonadPlus line 35, column 1 - line 36, column 1: "+
[e.constructor.name]);}}})(PS["Control.MonadPlus"]=PS["Control.MonadPlus"]||{});(function(a){a.Monoid=function(a,b){this["__superclass_Prelude.Semigroup_0"]=a;this.mempty=b};a.mempty=function(a){return a.mempty}})(PS["Data.Monoid"]=PS["Data.Monoid"]||{});
(function(a){var c=PS.Prelude,b=PS["Control.Alt"],d=PS["Control.Alternative"],e=PS["Control.MonadPlus"],f=PS["Control.Plus"],g=function(){function a(){}a.value=new a;return a}(),l=function(){function a(c){this.value0=c}a.create=function(c){return new a(c)};return a}(),k=new c.Functor(function(a){return function(c){return c instanceof l?new l(a(c.value0)):g.value}}),n=new c.Apply(function(){return k},function(a){return function(b){if(a instanceof l)return c["<$>"](k)(a.value0)(b);if(a instanceof g)return g.value;
throw Error("Failed pattern match at Data.Maybe line 121, column 1 - line 145, column 1: "+[a.constructor.name,b.constructor.name]);}}),m=new c.Bind(function(){return n},function(a){return function(c){if(a instanceof l)return c(a.value0);if(a instanceof g)return g.value;throw Error("Failed pattern match at Data.Maybe line 180, column 1 - line 199, column 1: "+[a.constructor.name,c.constructor.name]);}}),h=new c.Applicative(function(){return n},l.create),p=new c.Monad(function(){return h},function(){return m}),
q=new b.Alt(function(){return k},function(a){return function(c){return a instanceof g?c:a}}),s=new f.Plus(function(){return q},g.value),u=new d.Alternative(function(){return s},function(){return h}),b=new e.MonadPlus(function(){return u},function(){return p});a.Nothing=g;a.Just=l;a.functorMaybe=k;a.applyMaybe=n;a.applicativeMaybe=h;a.altMaybe=q;a.plusMaybe=s;a.alternativeMaybe=u;a.bindMaybe=m;a.monadMaybe=p;a.monadPlusMaybe=b})(PS["Data.Maybe"]=PS["Data.Maybe"]||{});
(function(a){var c=PS["Data.Maybe.Unsafe"],b=PS["Data.Maybe"];a.fromJust=function(a){if(a instanceof b.Just)return a.value0;if(a instanceof b.Nothing)return c.unsafeThrow("Data.Maybe.Unsafe.fromJust called on Nothing");throw Error("Failed pattern match at Data.Maybe.Unsafe line 10, column 1 - line 11, column 1: "+[a.constructor.name]);}})(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{});(function(a){a.toNumber=PS["Data.Int"].toNumber})(PS["Data.Int"]=PS["Data.Int"]||{});
(function(a){var c=PS["Control.Monad.Eff.Random"],b=PS.Prelude,d=PS["Control.Monad.Eff"];a.randomRange=function(a){return function(f){return function(){var g=c.random();return b["return"](d.applicativeEff)(g*(f-a)+a)()}}}})(PS["Control.Monad.Eff.Random"]=PS["Control.Monad.Eff.Random"]||{});
(function(a){a.newRef=function(a){return function(){return{value:a}}};a.readRef=function(a){return function(){return a.value}};a["modifyRef'"]=function(a){return function(b){return function(){var d=b(a.value);a.value=d.state;return d.value}}}})(PS["Control.Monad.Eff.Ref"]=PS["Control.Monad.Eff.Ref"]||{});
(function(a){var c=PS["Control.Monad.Eff.Ref"],b=PS.Prelude;a.modifyRef=function(a){return function(e){return c["modifyRef'"](a)(function(a){return{state:e(a),value:b.unit}})}};a.readRef=c.readRef;a.newRef=c.newRef})(PS["Control.Monad.Eff.Ref"]=PS["Control.Monad.Eff.Ref"]||{});(function(a){a.unsafeInterleaveEff=function(a){return a}})(PS["Control.Monad.Eff.Unsafe"]=PS["Control.Monad.Eff.Unsafe"]||{});
(function(a){a.unsafeInterleaveEff=PS["Control.Monad.Eff.Unsafe"].unsafeInterleaveEff})(PS["Control.Monad.Eff.Unsafe"]=PS["Control.Monad.Eff.Unsafe"]||{});(function(a){a.window=function(){return window}})(PS["DOM.HTML"]=PS["DOM.HTML"]||{});(function(a){a.window=PS["DOM.HTML"].window})(PS["DOM.HTML"]=PS["DOM.HTML"]||{});
(function(a){var c=null;a.requestAnimationFrame_=function(a){return function(d){c||(c=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||function(c){a.setTimeout(c,1E3/60)}}());return function(){return c(d)}}}})(PS["DOM.RequestAnimationFrame"]=PS["DOM.RequestAnimationFrame"]||{});
(function(a){var c=PS["DOM.RequestAnimationFrame"],b=PS["DOM.HTML"];a.requestAnimationFrame=function(a){return function(){var e=b.window();return c.requestAnimationFrame_(e)(a)()}}})(PS["DOM.RequestAnimationFrame"]=PS["DOM.RequestAnimationFrame"]||{});(function(a){a.nowEpochMilliseconds=function(){return Date.now()}})(PS["Data.Date"]=PS["Data.Date"]||{});
(function(a){var c=PS.Prelude,b=new c.Semiring(function(a){return function(c){return a+c}},function(a){return function(c){return a*c}},1,0),c=new c.Ring(function(){return b},function(a){return function(c){return a-c}});a.semiringMilliseconds=b;a.ringMilliseconds=c})(PS["Data.Time"]=PS["Data.Time"]||{});(function(a){a.nowEpochMilliseconds=PS["Data.Date"].nowEpochMilliseconds})(PS["Data.Date"]=PS["Data.Date"]||{});
(function(a){a.foldrArray=function(a){return function(b){return function(d){for(var e=b,f=d.length-1;0<=f;f--)e=a(d[f])(e);return e}}};a.foldlArray=function(a){return function(b){return function(d){for(var e=b,f=d.length,g=0;g<f;g++)e=a(e)(d[g]);return e}}}})(PS["Data.Foldable"]=PS["Data.Foldable"]||{});
(function(a){var c=PS.Prelude,b=PS["Data.Monoid"],d=function(a){return new c.Semigroup(function(b){return function(d){return c.disj(a)(b)(d)}})};a.Disj=function(a){return a};a.runDisj=function(a){return a};a.semigroupDisj=d;a.monoidDisj=function(a){return new b.Monoid(function(){return d(a)},c.bottom(a["__superclass_Prelude.Bounded_0"]()))}})(PS["Data.Monoid.Disj"]=PS["Data.Monoid.Disj"]||{});
(function(a){var c=PS["Data.Foldable"],b=PS.Prelude,d=PS["Data.Monoid"],e=PS["Control.Apply"],f=PS["Data.Monoid.Disj"],g=function(a,c,b){this.foldMap=a;this.foldl=c;this.foldr=b},l=function(a){return function(c){return function(d){return(0,c.foldr)(b["<<<"](b.semigroupoidFn)(e["*>"](a["__superclass_Prelude.Apply_0"]()))(d))(b.pure(a)(b.unit))}}},k=new g(function(a){return function(c){return function(f){return(0,k.foldr)(function(d){return function(f){return b["<>"](a["__superclass_Prelude.Semigroup_0"]())(c(d))(f)}})(d.mempty(a))(f)}}},
c.foldlArray,c.foldrArray);a.Foldable=g;a.any=function(a){return function(c){return function(d){return b["<<<"](b.semigroupoidFn)(f.runDisj)((0,a.foldMap)(f.monoidDisj(c))(b["<<<"](b.semigroupoidFn)(f.Disj)(d)))}}};a.for_=function(a){return function(c){return b.flip(l(a)(c))}};a.traverse_=l;a.foldMap=function(a){return a.foldMap};a.foldl=function(a){return a.foldl};a.foldr=function(a){return a.foldr};a.foldableArray=k})(PS["Data.Foldable"]=PS["Data.Foldable"]||{});
(function(a){a.defer=function(){function a(b){return this instanceof a?(this.thunk=b,this):new a(b)}a.prototype.force=function(){var a=this.thunk();delete this.thunk;this.force=function(){return a};return a};return a}();a.force=function(a){return a.force()}})(PS["Data.Lazy"]=PS["Data.Lazy"]||{});
(function(a){var c=PS["Data.Lazy"],b=new PS.Prelude.Functor(function(a){return function(b){return c.defer(function(f){return a(c.force(b))})}});a.functorLazy=b;a.force=c.force;a.defer=c.defer})(PS["Data.Lazy"]=PS["Data.Lazy"]||{});
(function(a){a.Traversable=function(a,b,d,e){this["__superclass_Data.Foldable.Foldable_1"]=a;this["__superclass_Prelude.Functor_0"]=b;this.sequence=d;this.traverse=e};a["for"]=function(a){return function(b){return function(d){return function(e){return(0,b.traverse)(a)(e)(d)}}}};a.sequence=function(a){return a.sequence};a.traverse=function(a){return a.traverse}})(PS["Data.Traversable"]=PS["Data.Traversable"]||{});
(function(a){var c=function(){function a(c,b){this.value0=c;this.value1=b}a.create=function(c){return function(e){return new a(c,e)}};return a}();a.Tuple=c})(PS["Data.Tuple"]=PS["Data.Tuple"]||{});
(function(a){var c=PS.Prelude,b=PS["Data.Foldable"],d=PS["Data.Traversable"],e=PS["Data.Monoid"],f=function(){function a(){}a.value=new a;return a}(),g=function(){function a(c,b){this.value0=c;this.value1=b}a.create=function(c){return function(b){return new a(c,b)}};return a}(),l=function(a){return new g(a,f.value)},k=new c.Semigroup(function(a){return function(b){if(a instanceof f)return b;if(a instanceof g)return new g(a.value0,c["<>"](k)(a.value1)(b));throw Error("Failed pattern match: "+[a.constructor.name,
b.constructor.name]);}}),n=function(a){return function(b){if(a===b)return l(a);if(c.otherwise)return function(a){return function(b){return function(s){return function(f){var d=a,e=b,u=s,h=f;a:for(;;){if(d===e)return new g(d,h);if(c.otherwise){f=d+u|0;h=new g(d,h);d=f;continue a}throw Error("Failed pattern match at Data.List line 137, column 1 - line 138, column 1: "+[d.constructor.name,e.constructor.name,u.constructor.name,h.constructor.name]);}}}}}(b)(a)(function(){var c=a>b;if(c)return 1;if(!c)return-1;
throw Error("Failed pattern match at Data.List line 137, column 1 - line 138, column 1: "+[c.constructor.name]);}())(f.value);throw Error("Failed pattern match at Data.List line 137, column 1 - line 138, column 1: "+[a.constructor.name,b.constructor.name]);}},m=new c.Functor(function(a){return function(b){if(b instanceof f)return f.value;if(b instanceof g)return new g(a(b.value0),c["<$>"](m)(a)(b.value1));throw Error("Failed pattern match: "+[a.constructor.name,b.constructor.name]);}}),h=new b.Foldable(function(a){return function(d){return function(t){if(t instanceof
f)return e.mempty(a);if(t instanceof g)return c["<>"](a["__superclass_Prelude.Semigroup_0"]())(d(t.value0))(b.foldMap(h)(a)(d)(t.value1));throw Error("Failed pattern match: "+[d.constructor.name,t.constructor.name]);}}},function(a){return function(c){return function(d){if(d instanceof f)return c;if(d instanceof g)return b.foldl(h)(a)(a(c)(d.value0))(d.value1);throw Error("Failed pattern match: "+[a.constructor.name,c.constructor.name,d.constructor.name]);}}},function(a){return function(c){return function(d){if(d instanceof
f)return c;if(d instanceof g)return a(d.value0)(b.foldr(h)(a)(c)(d.value1));throw Error("Failed pattern match: "+[a.constructor.name,c.constructor.name,d.constructor.name]);}}}),p=new d.Traversable(function(){return h},function(){return m},function(a){return function(b){if(b instanceof f)return c.pure(a)(f.value);if(b instanceof g)return c["<*>"](a["__superclass_Prelude.Apply_0"]())(c["<$>"](a["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(g.create)(b.value0))(d.sequence(p)(a)(b.value1));
throw Error("Failed pattern match: "+[b.constructor.name]);}},function(a){return function(b){return function(e){if(e instanceof f)return c.pure(a)(f.value);if(e instanceof g)return c["<*>"](a["__superclass_Prelude.Apply_0"]())(c["<$>"](a["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(g.create)(b(e.value0)))(d.traverse(p)(a)(b)(e.value1));throw Error("Failed pattern match: "+[b.constructor.name,e.constructor.name]);}}}),q=new c.Apply(function(){return m},function(a){return function(b){if(a instanceof
f)return f.value;if(a instanceof g)return c["<>"](k)(c["<$>"](m)(a.value0)(b))(c["<*>"](q)(a.value1)(b));throw Error("Failed pattern match: "+[a.constructor.name,b.constructor.name]);}});a.Nil=f;a.Cons=g;a.range=n;a[".."]=n;a.singleton=l;a.toList=function(a){return b.foldr(a)(g.create)(f.value)};a.semigroupList=k;a.functorList=m;a.foldableList=h;a.traversableList=p;a.applyList=q})(PS["Data.List"]=PS["Data.List"]||{});
(function(a){var c=PS.Prelude,b=PS["Data.Lazy"],d=PS["Control.Lazy"],e=PS["Data.Maybe"],f=function(a){return a},g=function(){function a(){}a.value=new a;return a}(),l=function(){function a(c,b){this.value0=c;this.value1=b}a.create=function(c){return function(b){return new a(c,b)}};return a}(),k=function(a){return a},n=c["<<<"](c.semigroupoidFn)(b.force)(k),m=function(a){a=n(a);if(a instanceof g)return e.Nothing.value;if(a instanceof l)return new e.Just({head:a.value0,tail:a.value1});throw Error("Failed pattern match at Data.List.Lazy line 278, column 1 - line 279, column 1: "+
[a.constructor.name]);},h=new d.Lazy(function(a){return f(b.defer(c["<<<"](c.semigroupoidFn)(n)(a)))}),p=new c.Functor(function(a){return function(d){return c["<$>"](b.functorLazy)(function(b){if(b instanceof g)return g.value;if(b instanceof l)return new l(a(b.value0),c["<$>"](p)(a)(b.value1));throw Error("Failed pattern match at Data.List.Lazy line 671, column 5 - line 672, column 5: "+[b.constructor.name]);})(d)}}),q=function(a){return function(c){return f(b.defer(function(b){return new l(a,c)}))}};
a.Nil=g;a.Cons=l;a.List=f;a.uncons=m;a.tail=function(a){return c["<$>"](e.functorMaybe)(function(a){return a.tail})(m(a))};a.head=function(a){return c["<$>"](e.functorMaybe)(function(a){return a.head})(m(a))};a.cons=q;a.iterate=function(a){return function(b){return d.fix(h)(function(d){return q(b)(c["<$>"](p)(a)(d))})}};a.step=n;a.runList=k;a.lazyList=h;a.functorList=p})(PS["Data.List.Lazy"]=PS["Data.List.Lazy"]||{});
(function(a){a.getCanvasElementByIdImpl=function(a,b,d){return function(){var e=document.getElementById(a);return e&&e instanceof HTMLCanvasElement?b(e):d}};a.getContext2D=function(a){return function(){return a.getContext("2d")}};a.setLineWidth=function(a){return function(b){return function(){b.lineWidth=a;return b}}};a.setFillStyle=function(a){return function(b){return function(){b.fillStyle=a;return b}}};a.setStrokeStyle=function(a){return function(b){return function(){b.strokeStyle=a;return b}}};
a.beginPath=function(a){return function(){a.beginPath();return a}};a.stroke=function(a){return function(){a.stroke();return a}};a.fill=function(a){return function(){a.fill();return a}};a.lineTo=function(a){return function(b){return function(d){return function(){a.lineTo(b,d);return a}}}};a.moveTo=function(a){return function(b){return function(d){return function(){a.moveTo(b,d);return a}}}};a.closePath=function(a){return function(){a.closePath();return a}};a.arc=function(a){return function(b){return function(){a.arc(b.x,
b.y,b.r,b.start,b.end);return a}}};a.fillRect=function(a){return function(b){return function(){a.fillRect(b.x,b.y,b.w,b.h);return a}}};a.strokeRect=function(a){return function(b){return function(){a.strokeRect(b.x,b.y,b.w,b.h);return a}}};a.scale=function(a){return function(b){return function(){b.scale(a.scaleX,a.scaleY);return b}}};a.translate=function(a){return function(b){return function(){b.translate(a.translateX,a.translateY);return b}}}})(PS["Graphics.Canvas"]=PS["Graphics.Canvas"]||{});
(function(a){var c=PS["Graphics.Canvas"],b=PS.Prelude,d=PS["Data.Maybe"],e=PS["Control.Monad.Eff"];a.fillPath=function(a){return function(d){return function(){c.beginPath(a)();var l=d();c.fill(a)();return b["return"](e.applicativeEff)(l)()}}};a.strokePath=function(a){return function(d){return function(){c.beginPath(a)();var l=d();c.stroke(a)();return b["return"](e.applicativeEff)(l)()}}};a.getCanvasElementById=function(a){return c.getCanvasElementByIdImpl(a,d.Just.create,d.Nothing.value)};a.translate=
c.translate;a.scale=c.scale;a.strokeRect=c.strokeRect;a.fillRect=c.fillRect;a.arc=c.arc;a.closePath=c.closePath;a.moveTo=c.moveTo;a.lineTo=c.lineTo;a.stroke=c.stroke;a.beginPath=c.beginPath;a.setStrokeStyle=c.setStrokeStyle;a.setFillStyle=c.setFillStyle;a.setLineWidth=c.setLineWidth;a.getContext2D=c.getContext2D})(PS["Graphics.Canvas"]=PS["Graphics.Canvas"]||{});
(function(a){a.onSpaceBar=function(a){return function(){window.addEventListener("keydown",function(b){32===b.keyCode&&a(!0)()},!1);window.addEventListener("keyup",function(b){32===b.keyCode&&a(!1)()},!1)}};a.onSpaceBarOnce=function(a){return function(){var b=function(d){32===d.keyCode&&a();window.removeEventListener("keydown",b)};window.addEventListener("keydown",b)}}})(PS.Main=PS.Main||{});
(function(a){var c=PS.Main,b=PS.Prelude,d=PS.Math,e=PS["Data.Int"],f=PS["Control.Monad.Eff"],g=PS["Control.Monad.Eff.Unsafe"],l=PS["Data.Traversable"],k=PS["Data.List"],n=PS["Control.Monad.Eff.Random"],m=PS["Data.List.Lazy"],h=PS["Graphics.Canvas"],p=PS["Control.Monad.Eff.Ref"],q=PS["Data.Maybe.Unsafe"],s=PS["Data.Foldable"],u=PS["Control.MonadPlus"],t=PS["Data.Date"],E=PS["DOM.RequestAnimationFrame"],r=PS["Data.Maybe"],B=PS["Data.Tuple"],F=PS["Data.Time"],y=function(){function a(){}a.value=new a;
return a}(),w=function(){function a(){}a.value=new a;return a}(),v=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),x=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),A=function(a){return function(b){return{x:a.x-b.x,y:a.y-b.y}}},D=function(a){return a.x*a.x+a.y*a.y},G=new b.Eq(function(a){return function(b){return a instanceof y&&b instanceof y||a instanceof w&&b instanceof w?!0:!1}}),H=function(a){return function(b){return D(A(b)(a))}},
z=function(a){return function(b){return function(c){return(1-d.exp(-e.toNumber(c)/2.5))*(b-a)+a}}},C=function(a){return b["<<<"](b.semigroupoidFn)(f.runPure)(g.unsafeInterleaveEff)(function(){var c=z(8.999999999999999E-5)(1.2000000000000002E-4)(a),d=z(0.005)(0.02)(a),g=z(0.13999999999999999)(0.04)(a);return function(){var a=l["for"](f.applicativeEff)(k.traversableList)(b["<*>"](k.applyList)(b["<$>"](k.functorList)(B.Tuple.create)(k[".."](0)(8)))(k[".."](2)(6)))(function(a){return function(){var c=
n.randomRange(-0.025)(0.025)(),g=n.randomRange(-0.025)(0.025)();return b["return"](f.applicativeEff)({x:0.15+0.7*e.toNumber(a.value0)/8+c,y:0.15+0.7*e.toNumber(a.value1)/8+g,r:d})()}})(),h=n.randomRange(0.25+g/2)(0.75-g/2)(),m=n.randomRange(0.25+g/2)(0.75-g/2)();return b["return"](f.applicativeEff)({stars:a,door:g,speed:c,entry:h,exit:m})()}}())},I=b["<$>"](m.functorList)(C)(m.iterate(b["+"](b.semiringInt)(1))(0)),J=function(a){return function(c){return function(d){if(b[">"](a)(c)(d))return d;if(b.otherwise)return c;
throw Error("Failed pattern match at Main line 85, column 1 - line 86, column 1: "+[c.constructor.name,d.constructor.name]);}}};a.Playing=v;a.Waiting=x;a.Up=y;a.Down=w;a.main=function(){var a=h.getCanvasElementById("canvas")();if(a instanceof r.Just){var e=h.getContext2D(a.value0)(),g=p.newRef({space:!1})();c.onSpaceBar(function(a){return p.modifyRef(g)(function(b){var c={},d;for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);c.space=a;return c})})();h.translate({translateX:0,translateY:-170})(e)();h.scale({scaleX:800,
scaleY:800})(e)();h.setLineWidth(0.001)(e)();var l=function(a){return function(c){if(c instanceof k.Cons&&c.value1 instanceof k.Cons){if(0.25>=c.value0.y||0.75<=c.value0.y||0.95<c.value0.x&&(c.value0.y<a.exit-a.door/2||c.value0.y>a.exit+a.door/2)||s.any(k.foldableList)(b.booleanAlgebraBoolean)(function(a){return H(c.value0)(a)<a.r*a.r})(a.stars))return!0;if(b.otherwise)return!1}throw Error("Failed pattern match at Main line 217, column 7 - line 218, column 7: "+[a.constructor.name,c.constructor.name]);
}},n=function(a){return function(){h.setStrokeStyle("lightgreen")(e)();return a instanceof k.Cons?b["void"](f.functorEff)(function(){h.beginPath(e)();h.moveTo(e)(a.value0.x)(a.value0.y)();s.for_(f.applicativeEff)(k.foldableList)(a.value1)(function(a){return h.lineTo(e)(a.x)(a.y)})();return h.stroke(e)()})():b["return"](f.applicativeEff)(b.unit)()}},z=function(a){return function(b){return function(c){if(c.space)c=y.value;else{if(c.space)throw Error("Failed pattern match at Main line 111, column 1 - line 233, column 28: "+
[c.space.constructor.name]);c=w.value}return new v({path:a,level:b,direction:c})}}},B=function(a){return function(c){return function(d){return function(e){var f;if(d)f=1;else{if(d)throw Error("Failed pattern match at Main line 164, column 13 - line 167, column 9: "+[d.constructor.name]);f=-1}e=J(b.ordNumber)(e)(50);var g={x:c.x+a.speed*e,y:c.y+f*a.speed*e};return b.bind(r.bindMaybe)(u.guard(r.monadPlusMaybe)(0.95>g.x||g.y<a.exit-a.door/2||g.y>a.exit+a.door/2))(function(){return b["return"](r.applicativeMaybe)(g)})}}}},
A=function(a){return new x({path:k.Nil.value,nextLevel:a})},D=function(a){return function(c){return function(d){if(d instanceof v&&d.value0.path instanceof k.Cons){if(l(q.fromJust(m.head(d.value0.level)))(d.value0.path))return r.Just.create(new x({path:d.value0.path,nextLevel:d.value0.level}));if(b["=="](b.eqBoolean)(b["=="](G)(d.value0.direction)(y.value))(a.space)){var e=B(q.fromJust(m.head(d.value0.level)))(d.value0.path.value0)(a.space)(c);if(e instanceof r.Just)return r.Just.create(z(new k.Cons(e.value0,
d.value0.path.value1))(d.value0.level)(a));if(e instanceof r.Nothing)return r.Just.create(A(q.fromJust(m.tail(d.value0.level))));throw Error("Failed pattern match at Main line 111, column 1 - line 233, column 28: "+[e.constructor.name]);}if(b.otherwise)return r.Just.create(z(new k.Cons(d.value0.path.value0,new k.Cons(d.value0.path.value0,d.value0.path.value1)))(d.value0.level)(a))}if(d instanceof x){if(a.space){e=r.Just;d=d.value0.nextLevel;var f={x:0.05,y:q.fromJust(m.head(d)).entry};d=new v({path:k.toList(s.foldableArray)([f,
f]),direction:w.value,level:d});return new e(d)}if(!a.space)return r.Nothing.value;throw Error("Failed pattern match at Main line 111, column 1 - line 233, column 28: "+[a.space.constructor.name]);}throw Error("Failed pattern match at Main line 111, column 1 - line 233, column 28: "+[a.constructor.name,c.constructor.name,d.constructor.name]);}}},C=function(a){return b["void"](f.functorEff)(function(){var b=q.fromJust(m.head(a));return function(){h.setFillStyle("black")(e)();h.fillRect(e)({x:0,y:0,
w:1,h:1})();h.setStrokeStyle("lightgreen")(e)();h.strokeRect(e)({x:0.05,y:0.25,w:0.9,h:0.5})();h.strokeRect(e)({x:0.045,y:0.24500000000000002,w:0.9099999999999999,h:0.51})();h.setFillStyle("lightgreen")(e)();h.fillRect(e)({x:0.045,y:b.entry-b.door/2,w:0.005,h:b.door})();h.fillRect(e)({x:0.95,y:b.exit-b.door/2,w:0.005,h:b.door})();h.setFillStyle("#222")(e)();h.setStrokeStyle("lightgreen")(e)();return s.for_(f.applicativeEff)(k.foldableList)(b.stars)(function(a){var b=function(){h.arc(e)({x:a.x,y:a.y,
r:a.r,start:0,end:2*d.pi})();return h.closePath(e)()};return function(){h.fillPath(e)(b)();return h.strokePath(e)(b)()}})()}}())},K=function(a){if(a instanceof x)return b["void"](f.functorEff)(function(){C(a.value0.nextLevel)();return n(a.value0.path)()});if(a instanceof v)return b["void"](f.functorEff)(function(){C(a.value0.level)();return n(a.value0.path)()});throw Error("Failed pattern match at Main line 111, column 1 - line 233, column 28: "+[a.constructor.name]);};return function(a){var d=function(a){return function(){var e=
t.nowEpochMilliseconds(),f=p.readRef(g)();return E.requestAnimationFrame(function(){var g=t.nowEpochMilliseconds();return function(){var h=D(f)(b["-"](F.ringMilliseconds)(g)(e))(a);if(h instanceof r.Just)return function(){K(h.value0)();return d(h.value0)()};if(h instanceof r.Nothing)return c.onSpaceBarOnce(d(a));throw Error("Failed pattern match at Main line 111, column 1 - line 233, column 28: "+[h.constructor.name]);}()()})()}};return function(){K(a)();return d(a)()}}(A(I))()}throw Error("Failed pattern match at Main line 111, column 1 - line 233, column 28: "+
[a.constructor.name]);};a.levels=I;a.unsafeLevel=C;a.clamp=J;a.decay=z;a.subtract=A;a.len2=D;a.dist2=H;a.eqDirection=G;a.onSpaceBarOnce=c.onSpaceBarOnce;a.onSpaceBar=c.onSpaceBar})(PS.Main=PS.Main||{});
