var PS={};(function(a){a.intAdd=function(a){return function(b){return a+b|0}};a.intMul=function(a){return function(b){return a*b|0}};a.refEq=function(a){return function(b){return a===b}};a.unsafeCompareImpl=function(a){return function(b){return function(d){return function(f){return function(g){return f<g?a:f>g?d:b}}}}};a.boolOr=function(a){return function(b){return a||b}};a.boolAnd=function(a){return function(b){return a&&b}};a.boolNot=function(a){return!a}})(PS.Prelude=PS.Prelude||{});
(function(a){var c=PS.Prelude,b=function(){function a(){}a.value=new a;return a}(),d=function(){function a(){}a.value=new a;return a}(),f=function(){function a(){}a.value=new a;return a}(),g=function(a){this.compose=a},e=function(a,c){this["__superclass_Prelude.Semigroupoid_0"]=a;this.id=c},n=function(a,c,b,r){this.add=a;this.mul=c;this.one=b;this.zero=r},m=function(a){this.eq=a},q=function(a,c){this["__superclass_Prelude.Eq_0"]=a;this.compare=c},h=function(a,c){this.bottom=a;this.top=c},k=function(a,
c,b,r){this["__superclass_Prelude.Bounded_0"]=a;this.conj=c;this.disj=b;this.not=r},u=c.unsafeCompareImpl(b.value)(f.value)(d.value),t={},p=new n(c.intAdd,c.intMul,1,0),x=new g(function(a){return function(c){return function(b){return a(c(b))}}}),r=function(a){return a.pure},l=new m(c.refEq),y=new q(function(){return l},u),F=new m(c.refEq),G=function(a){return function(c){return a}},v=new e(function(){return x},function(a){return a}),z=new h(!1,!0),H=function(a){return new h(function(c){return a.bottom},
function(c){return a.top})},c=new k(function(){return z},c.boolAnd,c.boolOr,c.boolNot),w=function(a){return a.bind},A=function(a){return a.apply};a.LT=b;a.GT=d;a.EQ=f;a.BooleanAlgebra=k;a.Bounded=h;a.Ord=q;a.Eq=m;a.Ring=function(a,c){this["__superclass_Prelude.Semiring_0"]=a;this.sub=c};a.Semiring=n;a.Semigroup=function(a){this.append=a};a.Monad=function(a,c){this["__superclass_Prelude.Applicative_0"]=a;this["__superclass_Prelude.Bind_1"]=c};a.Bind=function(a,c){this["__superclass_Prelude.Apply_0"]=
a;this.bind=c};a.Applicative=function(a,c){this["__superclass_Prelude.Apply_0"]=a;this.pure=c};a.Apply=function(a,c){this["__superclass_Prelude.Functor_0"]=a;this.apply=c};a.Functor=function(a){this.map=a};a.Category=e;a.Semigroupoid=g;a.not=function(a){return a.not};a.disj=function(a){return a.disj};a.conj=function(a){return a.conj};a.bottom=function(a){return a.bottom};a.top=function(a){return a.top};a.unsafeCompare=u;a[">"]=function(a){return function(c){return function(b){return(0,a.compare)(c)(b)instanceof
d?!0:!1}}};a.compare=function(a){return a.compare};a["=="]=function(a){return a.eq};a.eq=function(a){return a.eq};a["-"]=function(a){return a.sub};a.sub=function(a){return a.sub};a["+"]=function(a){return a.add};a.one=function(a){return a.one};a.mul=function(a){return a.mul};a.zero=function(a){return a.zero};a.add=function(a){return a.add};a["++"]=function(a){return a.append};a["<>"]=function(a){return a.append};a.append=function(a){return a.append};a.ap=function(a){return function(c){return function(b){return w(a["__superclass_Prelude.Bind_1"]())(c)(function(c){return w(a["__superclass_Prelude.Bind_1"]())(b)(function(b){return r(a["__superclass_Prelude.Applicative_0"]())(c(b))})})}}};
a["return"]=r;a.bind=w;a.liftA1=function(a){return function(c){return function(b){return A(a["__superclass_Prelude.Apply_0"]())((0,a.pure)(c))(b)}}};a.pure=function(a){return a.pure};a["<*>"]=A;a.apply=function(a){return a.apply};a["void"]=function(a){return function(c){return(0,a.map)(G(t))(c)}};a["<$>"]=function(a){return a.map};a.map=function(a){return a.map};a.id=function(a){return a.id};a["<<<"]=function(a){return a.compose};a.compose=function(a){return a.compose};a.otherwise=!0;a["const"]=G;
a.flip=function(a){return function(c){return function(b){return a(b)(c)}}};a.unit=t;a.semigroupoidFn=x;a.categoryFn=v;a.semiringInt=p;a.eqBoolean=F;a.eqNumber=l;a.ordNumber=y;a.boundedBoolean=z;a.boundedFn=H;a.booleanAlgebraBoolean=c;a.booleanAlgebraFn=function(a){return new k(function(){return H(a["__superclass_Prelude.Bounded_0"]())},function(c){return function(b){return function(r){return(0,a.conj)(c(r))(b(r))}}},function(c){return function(b){return function(r){return(0,a.disj)(c(r))(b(r))}}},
function(c){return function(b){return(0,a.not)(c(b))}})}})(PS.Prelude=PS.Prelude||{});(function(a){a.Alt=function(a,b){this["__superclass_Prelude.Functor_0"]=a;this.alt=b};a["<|>"]=function(a){return a.alt};a.alt=function(a){return a.alt}})(PS["Control.Alt"]=PS["Control.Alt"]||{});
(function(a){var c=function(a){return function(d){return(0,a.defer)(function(f){return d(c(a)(d))})}};a.Lazy=function(a){this.defer=a};a.fix=c;a.defer=function(a){return a.defer}})(PS["Control.Lazy"]=PS["Control.Lazy"]||{});(function(a){a.Plus=function(a,b){this["__superclass_Control.Alt.Alt_0"]=a;this.empty=b};a.empty=function(a){return a.empty}})(PS["Control.Plus"]=PS["Control.Plus"]||{});
(function(a){a.Alternative=function(a,b){this["__superclass_Control.Plus.Plus_1"]=a;this["__superclass_Prelude.Applicative_0"]=b}})(PS["Control.Alternative"]=PS["Control.Alternative"]||{});(function(a){var c=PS.Prelude;a["*>"]=function(a){return function(d){return function(f){return c["<*>"](a)(c["<$>"](a["__superclass_Prelude.Functor_0"]())(c["const"](c.id(c.categoryFn)))(d))(f)}}}})(PS["Control.Apply"]=PS["Control.Apply"]||{});
(function(a){var c=PS.Prelude;a.when=function(a){return function(d){return function(f){if(d)return f;if(!d)return c["return"](a["__superclass_Prelude.Applicative_0"]())(c.unit);throw Error("Failed pattern match at Control.Monad line 8, column 1 - line 9, column 1: "+[d.constructor.name,f.constructor.name]);}}}})(PS["Control.Monad"]=PS["Control.Monad"]||{});
(function(a){a.returnE=function(a){return function(){return a}};a.bindE=function(a){return function(b){return function(){return b(a())()}}};a.runPure=function(a){return a()}})(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{});
(function(a){var c=PS["Control.Monad.Eff"],b=PS.Prelude,d=new b.Monad(function(){return e},function(){return f}),f=new b.Bind(function(){return g},c.bindE),g=new b.Apply(function(){return n},b.ap(d)),e=new b.Applicative(function(){return g},c.returnE),n=new b.Functor(b.liftA1(e));a.functorEff=n;a.applyEff=g;a.applicativeEff=e;a.bindEff=f;a.monadEff=d;a.runPure=c.runPure})(PS["Control.Monad.Eff"]=PS["Control.Monad.Eff"]||{});
(function(a){a.random=Math.random})(PS["Control.Monad.Eff.Random"]=PS["Control.Monad.Eff.Random"]||{});(function(a){a.toNumber=function(a){return a}})(PS["Data.Int"]=PS["Data.Int"]||{});(function(a){a.exp=Math.exp;a.pi=Math.PI})(PS.Math=PS.Math||{});(function(a){var c=PS.Math;a.pi=c.pi;a.exp=c.exp})(PS.Math=PS.Math||{});(function(a){a.unsafeThrow=function(a){throw Error(a);}})(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{});
(function(a){var c=PS.Prelude,b=PS["Control.Plus"];a.MonadPlus=function(a,c){this["__superclass_Control.Alternative.Alternative_1"]=a;this["__superclass_Prelude.Monad_0"]=c};a.guard=function(a){return function(f){if(f)return c["return"](a["__superclass_Control.Alternative.Alternative_1"]()["__superclass_Prelude.Applicative_0"]())(c.unit);if(!f)return b.empty(a["__superclass_Control.Alternative.Alternative_1"]()["__superclass_Control.Plus.Plus_1"]());throw Error("Failed pattern match at Control.MonadPlus line 35, column 1 - line 36, column 1: "+
[f.constructor.name]);}}})(PS["Control.MonadPlus"]=PS["Control.MonadPlus"]||{});(function(a){a.Monoid=function(a,b){this["__superclass_Prelude.Semigroup_0"]=a;this.mempty=b};a.mempty=function(a){return a.mempty}})(PS["Data.Monoid"]=PS["Data.Monoid"]||{});
(function(a){var c=PS.Prelude,b=PS["Control.Alt"],d=PS["Control.Alternative"],f=PS["Control.MonadPlus"],g=PS["Control.Plus"],e=function(){function a(){}a.value=new a;return a}(),n=function(){function a(c){this.value0=c}a.create=function(c){return new a(c)};return a}(),m=new c.Functor(function(a){return function(c){return c instanceof n?new n(a(c.value0)):e.value}}),q=new c.Apply(function(){return m},function(a){return function(b){if(a instanceof n)return c["<$>"](m)(a.value0)(b);if(a instanceof e)return e.value;
throw Error("Failed pattern match at Data.Maybe line 121, column 1 - line 145, column 1: "+[a.constructor.name,b.constructor.name]);}}),h=new c.Bind(function(){return q},function(a){return function(c){if(a instanceof n)return c(a.value0);if(a instanceof e)return e.value;throw Error("Failed pattern match at Data.Maybe line 180, column 1 - line 199, column 1: "+[a.constructor.name,c.constructor.name]);}}),k=new c.Applicative(function(){return q},n.create),u=new c.Monad(function(){return k},function(){return h}),
t=new b.Alt(function(){return m},function(a){return function(c){return a instanceof e?c:a}}),p=new g.Plus(function(){return t},e.value),x=new d.Alternative(function(){return p},function(){return k}),b=new f.MonadPlus(function(){return x},function(){return u});a.Nothing=e;a.Just=n;a.functorMaybe=m;a.applyMaybe=q;a.applicativeMaybe=k;a.altMaybe=t;a.plusMaybe=p;a.alternativeMaybe=x;a.bindMaybe=h;a.monadMaybe=u;a.monadPlusMaybe=b})(PS["Data.Maybe"]=PS["Data.Maybe"]||{});
(function(a){var c=PS["Data.Maybe.Unsafe"],b=PS["Data.Maybe"];a.fromJust=function(a){if(a instanceof b.Just)return a.value0;if(a instanceof b.Nothing)return c.unsafeThrow("Data.Maybe.Unsafe.fromJust called on Nothing");throw Error("Failed pattern match at Data.Maybe.Unsafe line 10, column 1 - line 11, column 1: "+[a.constructor.name]);}})(PS["Data.Maybe.Unsafe"]=PS["Data.Maybe.Unsafe"]||{});(function(a){a.toNumber=PS["Data.Int"].toNumber})(PS["Data.Int"]=PS["Data.Int"]||{});
(function(a){var c=PS["Control.Monad.Eff.Random"],b=PS.Prelude,d=PS["Control.Monad.Eff"];a.randomRange=function(a){return function(g){return function(){var e=c.random();return b["return"](d.applicativeEff)(e*(g-a)+a)()}}}})(PS["Control.Monad.Eff.Random"]=PS["Control.Monad.Eff.Random"]||{});
(function(a){a.newRef=function(a){return function(){return{value:a}}};a.readRef=function(a){return function(){return a.value}};a["modifyRef'"]=function(a){return function(b){return function(){var d=b(a.value);a.value=d.state;return d.value}}}})(PS["Control.Monad.Eff.Ref"]=PS["Control.Monad.Eff.Ref"]||{});
(function(a){var c=PS["Control.Monad.Eff.Ref"],b=PS.Prelude;a.modifyRef=function(a){return function(f){return c["modifyRef'"](a)(function(a){return{state:f(a),value:b.unit}})}};a.readRef=c.readRef;a.newRef=c.newRef})(PS["Control.Monad.Eff.Ref"]=PS["Control.Monad.Eff.Ref"]||{});(function(a){a.unsafeInterleaveEff=function(a){return a}})(PS["Control.Monad.Eff.Unsafe"]=PS["Control.Monad.Eff.Unsafe"]||{});
(function(a){a.unsafeInterleaveEff=PS["Control.Monad.Eff.Unsafe"].unsafeInterleaveEff})(PS["Control.Monad.Eff.Unsafe"]=PS["Control.Monad.Eff.Unsafe"]||{});(function(a){a.window=function(){return window}})(PS["DOM.HTML"]=PS["DOM.HTML"]||{});(function(a){a.window=PS["DOM.HTML"].window})(PS["DOM.HTML"]=PS["DOM.HTML"]||{});
(function(a){var c=null;a.requestAnimationFrame_=function(a){return function(d){c||(c=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||function(c){a.setTimeout(c,1E3/60)}}());return function(){return c(d)}}}})(PS["DOM.RequestAnimationFrame"]=PS["DOM.RequestAnimationFrame"]||{});
(function(a){var c=PS["DOM.RequestAnimationFrame"],b=PS["DOM.HTML"];a.requestAnimationFrame=function(a){return function(){var f=b.window();return c.requestAnimationFrame_(f)(a)()}}})(PS["DOM.RequestAnimationFrame"]=PS["DOM.RequestAnimationFrame"]||{});(function(a){a.nowEpochMilliseconds=function(){return Date.now()}})(PS["Data.Date"]=PS["Data.Date"]||{});
(function(a){var c=PS.Prelude,b=new c.Semiring(function(a){return function(c){return a+c}},function(a){return function(c){return a*c}},1,0),c=new c.Ring(function(){return b},function(a){return function(c){return a-c}});a.semiringMilliseconds=b;a.ringMilliseconds=c})(PS["Data.Time"]=PS["Data.Time"]||{});(function(a){a.nowEpochMilliseconds=PS["Data.Date"].nowEpochMilliseconds})(PS["Data.Date"]=PS["Data.Date"]||{});
(function(a){a.foldrArray=function(a){return function(b){return function(d){for(var f=b,g=d.length-1;0<=g;g--)f=a(d[g])(f);return f}}};a.foldlArray=function(a){return function(b){return function(d){for(var f=b,g=d.length,e=0;e<g;e++)f=a(f)(d[e]);return f}}}})(PS["Data.Foldable"]=PS["Data.Foldable"]||{});
(function(a){var c=PS.Prelude,b=PS["Data.Monoid"],d=function(a){return new c.Semigroup(function(b){return function(e){return c.disj(a)(b)(e)}})};a.Disj=function(a){return a};a.runDisj=function(a){return a};a.semigroupDisj=d;a.monoidDisj=function(a){return new b.Monoid(function(){return d(a)},c.bottom(a["__superclass_Prelude.Bounded_0"]()))}})(PS["Data.Monoid.Disj"]=PS["Data.Monoid.Disj"]||{});
(function(a){var c=PS["Data.Foldable"],b=PS.Prelude,d=PS["Data.Monoid"],f=PS["Control.Apply"],g=PS["Data.Monoid.Disj"],e=PS["Data.Maybe"],n=function(a,c,b){this.foldMap=a;this.foldl=c;this.foldr=b},m=function(a){return function(c){return function(e){return(0,c.foldr)(b["<<<"](b.semigroupoidFn)(f["*>"](a["__superclass_Prelude.Apply_0"]()))(e))(b.pure(a)(b.unit))}}},q=new n(function(a){return function(c){return function(b){if(b instanceof e.Nothing)return d.mempty(a);if(b instanceof e.Just)return c(b.value0);
throw Error("Failed pattern match at Data.Foldable line 51, column 1 - line 59, column 1: "+[c.constructor.name,b.constructor.name]);}}},function(a){return function(c){return function(b){if(b instanceof e.Nothing)return c;if(b instanceof e.Just)return a(c)(b.value0);throw Error("Failed pattern match at Data.Foldable line 51, column 1 - line 59, column 1: "+[a.constructor.name,c.constructor.name,b.constructor.name]);}}},function(a){return function(c){return function(b){if(b instanceof e.Nothing)return c;
if(b instanceof e.Just)return a(b.value0)(c);throw Error("Failed pattern match at Data.Foldable line 51, column 1 - line 59, column 1: "+[a.constructor.name,c.constructor.name,b.constructor.name]);}}}),h=new n(function(a){return function(c){return function(e){return(0,h.foldr)(function(e){return function(g){return b["<>"](a["__superclass_Prelude.Semigroup_0"]())(c(e))(g)}})(d.mempty(a))(e)}}},c.foldlArray,c.foldrArray);a.Foldable=n;a.any=function(a){return function(c){return function(e){return b["<<<"](b.semigroupoidFn)(g.runDisj)((0,a.foldMap)(g.monoidDisj(c))(b["<<<"](b.semigroupoidFn)(g.Disj)(e)))}}};
a.for_=function(a){return function(c){return b.flip(m(a)(c))}};a.traverse_=m;a.fold=function(a){return function(c){return(0,a.foldMap)(c)(b.id(b.categoryFn))}};a.foldMap=function(a){return a.foldMap};a.foldl=function(a){return a.foldl};a.foldr=function(a){return a.foldr};a.foldableArray=h;a.foldableMaybe=q})(PS["Data.Foldable"]=PS["Data.Foldable"]||{});
(function(a){a.defer=function(){function a(b){return this instanceof a?(this.thunk=b,this):new a(b)}a.prototype.force=function(){var a=this.thunk();delete this.thunk;this.force=function(){return a};return a};return a}();a.force=function(a){return a.force()}})(PS["Data.Lazy"]=PS["Data.Lazy"]||{});
(function(a){var c=PS["Data.Lazy"],b=new PS.Prelude.Functor(function(a){return function(b){return c.defer(function(g){return a(c.force(b))})}});a.functorLazy=b;a.force=c.force;a.defer=c.defer})(PS["Data.Lazy"]=PS["Data.Lazy"]||{});
(function(a){a.Traversable=function(a,b,d,f){this["__superclass_Data.Foldable.Foldable_1"]=a;this["__superclass_Prelude.Functor_0"]=b;this.sequence=d;this.traverse=f};a["for"]=function(a){return function(b){return function(d){return function(f){return(0,b.traverse)(a)(f)(d)}}}};a.sequence=function(a){return a.sequence};a.traverse=function(a){return a.traverse}})(PS["Data.Traversable"]=PS["Data.Traversable"]||{});
(function(a){var c=function(){function a(c,b){this.value0=c;this.value1=b}a.create=function(c){return function(f){return new a(c,f)}};return a}();a.Tuple=c})(PS["Data.Tuple"]=PS["Data.Tuple"]||{});
(function(a){var c=PS.Prelude,b=PS["Data.Foldable"],d=PS["Data.Traversable"],f=PS["Data.Monoid"],g=function(){function a(){}a.value=new a;return a}(),e=function(){function a(c,b){this.value0=c;this.value1=b}a.create=function(c){return function(b){return new a(c,b)}};return a}(),n=e.create,m=function(a){return new e(a,g.value)},q=new c.Semigroup(function(a){return function(b){if(a instanceof g)return b;if(a instanceof e)return new e(a.value0,c["<>"](q)(a.value1)(b));throw Error("Failed pattern match: "+
[a.constructor.name,b.constructor.name]);}}),h=function(a){return function(b){if(a===b)return m(a);if(c.otherwise)return function(a){return function(b){return function(g){return function(d){var r=a,f=b,l=g,p=d;a:for(;;){if(r===f)return new e(r,p);if(c.otherwise){d=r+l|0;p=new e(r,p);r=d;continue a}throw Error("Failed pattern match at Data.List line 137, column 1 - line 138, column 1: "+[r.constructor.name,f.constructor.name,l.constructor.name,p.constructor.name]);}}}}}(b)(a)(function(){var c=a>b;
if(c)return 1;if(!c)return-1;throw Error("Failed pattern match at Data.List line 137, column 1 - line 138, column 1: "+[c.constructor.name]);}())(g.value);throw Error("Failed pattern match at Data.List line 137, column 1 - line 138, column 1: "+[a.constructor.name,b.constructor.name]);}},k=new f.Monoid(function(){return q},g.value),u=new c.Functor(function(a){return function(b){if(b instanceof g)return g.value;if(b instanceof e)return new e(a(b.value0),c["<$>"](u)(a)(b.value1));throw Error("Failed pattern match: "+
[a.constructor.name,b.constructor.name]);}}),t=new b.Foldable(function(a){return function(d){return function(p){if(p instanceof g)return f.mempty(a);if(p instanceof e)return c["<>"](a["__superclass_Prelude.Semigroup_0"]())(d(p.value0))(b.foldMap(t)(a)(d)(p.value1));throw Error("Failed pattern match: "+[d.constructor.name,p.constructor.name]);}}},function(a){return function(c){return function(d){if(d instanceof g)return c;if(d instanceof e)return b.foldl(t)(a)(a(c)(d.value0))(d.value1);throw Error("Failed pattern match: "+
[a.constructor.name,c.constructor.name,d.constructor.name]);}}},function(a){return function(c){return function(d){if(d instanceof g)return c;if(d instanceof e)return a(d.value0)(b.foldr(t)(a)(c)(d.value1));throw Error("Failed pattern match: "+[a.constructor.name,c.constructor.name,d.constructor.name]);}}}),p=new d.Traversable(function(){return t},function(){return u},function(a){return function(b){if(b instanceof g)return c.pure(a)(g.value);if(b instanceof e)return c["<*>"](a["__superclass_Prelude.Apply_0"]())(c["<$>"](a["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(e.create)(b.value0))(d.sequence(p)(a)(b.value1));
throw Error("Failed pattern match: "+[b.constructor.name]);}},function(a){return function(b){return function(f){if(f instanceof g)return c.pure(a)(g.value);if(f instanceof e)return c["<*>"](a["__superclass_Prelude.Apply_0"]())(c["<$>"](a["__superclass_Prelude.Apply_0"]()["__superclass_Prelude.Functor_0"]())(e.create)(b(f.value0)))(d.traverse(p)(a)(b)(f.value1));throw Error("Failed pattern match: "+[b.constructor.name,f.constructor.name]);}}}),x=new c.Apply(function(){return u},function(a){return function(b){if(a instanceof
g)return g.value;if(a instanceof e)return c["<>"](q)(c["<$>"](u)(a.value0)(b))(c["<*>"](x)(a.value1)(b));throw Error("Failed pattern match: "+[a.constructor.name,b.constructor.name]);}});a.Nil=g;a.Cons=e;a[":"]=n;a["null"]=function(a){return a instanceof g?!0:!1};a.range=h;a[".."]=h;a.singleton=m;a.toList=function(a){return b.foldr(a)(e.create)(g.value)};a.semigroupList=q;a.monoidList=k;a.functorList=u;a.foldableList=t;a.traversableList=p;a.applyList=x})(PS["Data.List"]=PS["Data.List"]||{});
(function(a){var c=PS.Prelude,b=PS["Data.Lazy"],d=PS["Control.Lazy"],f=PS["Data.Maybe"],g=function(a){return a},e=function(){function a(){}a.value=new a;return a}(),n=function(){function a(c,b){this.value0=c;this.value1=b}a.create=function(c){return function(b){return new a(c,b)}};return a}(),m=function(a){return a},q=c["<<<"](c.semigroupoidFn)(b.force)(m),h=function(a){a=q(a);if(a instanceof e)return f.Nothing.value;if(a instanceof n)return new f.Just({head:a.value0,tail:a.value1});throw Error("Failed pattern match at Data.List.Lazy line 278, column 1 - line 279, column 1: "+
[a.constructor.name]);},k=new d.Lazy(function(a){return g(b.defer(c["<<<"](c.semigroupoidFn)(q)(a)))}),u=new c.Functor(function(a){return function(g){return c["<$>"](b.functorLazy)(function(b){if(b instanceof e)return e.value;if(b instanceof n)return new n(a(b.value0),c["<$>"](u)(a)(b.value1));throw Error("Failed pattern match at Data.List.Lazy line 671, column 5 - line 672, column 5: "+[b.constructor.name]);})(g)}}),t=function(a){return function(c){return g(b.defer(function(b){return new n(a,c)}))}};
a.Nil=e;a.Cons=n;a.List=g;a.uncons=h;a.tail=function(a){return c["<$>"](f.functorMaybe)(function(a){return a.tail})(h(a))};a.head=function(a){return c["<$>"](f.functorMaybe)(function(a){return a.head})(h(a))};a.cons=t;a.iterate=function(a){return function(b){return d.fix(k)(function(e){return t(b)(c["<$>"](u)(a)(e))})}};a.step=q;a.runList=m;a.lazyList=k;a.functorList=u})(PS["Data.List.Lazy"]=PS["Data.List.Lazy"]||{});
(function(a){a.getCanvasElementByIdImpl=function(a,b,d){return function(){var f=document.getElementById(a);return f&&f instanceof HTMLCanvasElement?b(f):d}};a.getContext2D=function(a){return function(){return a.getContext("2d")}};a.setLineWidth=function(a){return function(b){return function(){b.lineWidth=a;return b}}};a.setFillStyle=function(a){return function(b){return function(){b.fillStyle=a;return b}}};a.setStrokeStyle=function(a){return function(b){return function(){b.strokeStyle=a;return b}}};
a.setShadowColor=function(a){return function(b){return function(){b.shadowColor=a;return b}}};a.setShadowBlur=function(a){return function(b){return function(){b.shadowBlur=a;return b}}};a.setShadowOffsetX=function(a){return function(b){return function(){b.shadowOffsetX=a;return b}}};a.setShadowOffsetY=function(a){return function(b){return function(){b.shadowOffsetY=a;return b}}};a.beginPath=function(a){return function(){a.beginPath();return a}};a.stroke=function(a){return function(){a.stroke();return a}};
a.fill=function(a){return function(){a.fill();return a}};a.clip=function(a){return function(){a.clip();return a}};a.lineTo=function(a){return function(b){return function(d){return function(){a.lineTo(b,d);return a}}}};a.moveTo=function(a){return function(b){return function(d){return function(){a.moveTo(b,d);return a}}}};a.closePath=function(a){return function(){a.closePath();return a}};a.arc=function(a){return function(b){return function(){a.arc(b.x,b.y,b.r,b.start,b.end);return a}}};a.rect=function(a){return function(b){return function(){a.rect(b.x,
b.y,b.w,b.h);return a}}};a.fillRect=function(a){return function(b){return function(){a.fillRect(b.x,b.y,b.w,b.h);return a}}};a.scale=function(a){return function(b){return function(){b.scale(a.scaleX,a.scaleY);return b}}};a.rotate=function(a){return function(b){return function(){b.rotate(a);return b}}};a.translate=function(a){return function(b){return function(){b.translate(a.translateX,a.translateY);return b}}};a.save=function(a){return function(){a.save();return a}};a.restore=function(a){return function(){a.restore();
return a}}})(PS["Graphics.Canvas"]=PS["Graphics.Canvas"]||{});
(function(a){var c=PS["Graphics.Canvas"],b=PS.Prelude,d=PS["Data.Maybe"],f=PS["Control.Monad.Eff"];a.withContext=function(a){return function(e){return function(){c.save(a)();var d=e();c.restore(a)();return b["return"](f.applicativeEff)(d)()}}};a.fillPath=function(a){return function(e){return function(){c.beginPath(a)();var d=e();c.fill(a)();return b["return"](f.applicativeEff)(d)()}}};a.strokePath=function(a){return function(e){return function(){c.beginPath(a)();var d=e();c.stroke(a)();return b["return"](f.applicativeEff)(d)()}}};
a.getCanvasElementById=function(a){return c.getCanvasElementByIdImpl(a,d.Just.create,d.Nothing.value)};a.translate=c.translate;a.rotate=c.rotate;a.scale=c.scale;a.fillRect=c.fillRect;a.rect=c.rect;a.arc=c.arc;a.closePath=c.closePath;a.moveTo=c.moveTo;a.lineTo=c.lineTo;a.clip=c.clip;a.setShadowColor=c.setShadowColor;a.setShadowOffsetY=c.setShadowOffsetY;a.setShadowOffsetX=c.setShadowOffsetX;a.setShadowBlur=c.setShadowBlur;a.setStrokeStyle=c.setStrokeStyle;a.setFillStyle=c.setFillStyle;a.setLineWidth=
c.setLineWidth;a.getContext2D=c.getContext2D})(PS["Graphics.Canvas"]=PS["Graphics.Canvas"]||{});(function(a){a.byteToHex=function(a){var b=(a=Math.min(255,Math.max(a,0))|0).toString(16);return 16<=a?b:"0"+b}})(PS["Graphics.Drawing.Color"]=PS["Graphics.Drawing.Color"]||{});
(function(a){var c=PS["Graphics.Drawing.Color"],b=function(){function a(b,c,e){this.value0=b;this.value1=c;this.value2=e}a.create=function(b){return function(c){return function(d){return new a(b,c,d)}}};return a}(),d=b.create,f=d(255)(255)(255),g=d(0)(128)(0);a.green=g;a.white=f;a.lighten=function(a){return function(c){return new b(255*a+c.value0*(1-a),255*a+c.value1*(1-a),255*a+c.value2*(1-a))}};a.rgb=d;a.colorString=function(a){return"#"+(c.byteToHex(a.value0)+(c.byteToHex(a.value1)+c.byteToHex(a.value2)))}})(PS["Graphics.Drawing.Color"]=
PS["Graphics.Drawing.Color"]||{});
(function(a){var c=PS.Prelude,b=PS["Data.List"],d=PS["Data.Monoid"],f=PS["Control.Alt"],g=PS["Graphics.Canvas"],e=PS["Data.Foldable"],n=PS["Graphics.Drawing.Color"],m=PS["Control.Monad"],q=PS.Math,h=PS["Data.Maybe"],k=PS["Control.Monad.Eff"],u=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),t=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),p=function(){function a(b){this.value0=b}
a.create=function(b){return new a(b)};return a}(),x=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),r=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),l=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),y=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),F=function(){function a(b,
c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),G=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),v=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),z=function(){function a(b,c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),H=function(){function a(b,
c){this.value0=b;this.value1=c}a.create=function(b){return function(c){return new a(b,c)}};return a}(),w=H.create,A=new c.Semigroup(function(a){return function(d){return a instanceof x?new x(c["++"](b.semigroupList)(a.value0)(b.singleton(d))):d instanceof x?new x(b[":"](a)(d.value0)):new x(new b.Cons(a,new b.Cons(d,b.Nil.value)))}}),D=new c.Semigroup(function(a){return function(b){return{color:f["<|>"](h.altMaybe)(a.color)(b.color),blur:f["<|>"](h.altMaybe)(a.blur)(b.blur),offset:f["<|>"](h.altMaybe)(a.offset)(b.offset)}}}),
B=new c.Semigroup(function(a){return function(d){return a instanceof y?new y(c["++"](b.semigroupList)(a.value0)(b.singleton(d))):d instanceof y?new y(b[":"](a)(d.value0)):new y(new b.Cons(a,new b.Cons(d,b.Nil.value)))}}),E=v.create,I=c.flip(l.create),d=new d.Monoid(function(){return B},new y(d.mempty(b.monoidList))),K=c.flip(r.create);a.render=function(a){var d=function(b){return function(){e.for_(k.applicativeEff)(e.foldableMaybe)(b.color)(function(b){return g.setShadowColor(n.colorString(b))(a)})();
e.for_(k.applicativeEff)(e.foldableMaybe)(b.blur)(function(b){return g.setShadowBlur(b)(a)})();return e.for_(k.applicativeEff)(e.foldableMaybe)(b.offset)(function(b){return function(){g.setShadowOffsetX(b.x)(a)();return g.setShadowOffsetY(b.y)(a)()}})()}},f=function(b){return function(){e.for_(k.applicativeEff)(e.foldableMaybe)(b.color)(function(b){return g.setStrokeStyle(n.colorString(b))(a)})();return e.for_(k.applicativeEff)(e.foldableMaybe)(b.lineWidth)(function(b){return g.setLineWidth(b)(a)})()}},
h=function(b){return e.for_(k.applicativeEff)(e.foldableMaybe)(b.color)(function(b){return g.setFillStyle(n.colorString(b))(a)})},w=function(s){if(s instanceof r)return c["void"](k.functorEff)(g.withContext(a)(function(){h(s.value1)();return g.fillPath(a)(L(s.value0))()}));if(s instanceof l)return c["void"](k.functorEff)(g.withContext(a)(function(){f(s.value1)();return g.strokePath(a)(L(s.value0))()}));if(s instanceof y)return e.for_(k.applicativeEff)(b.foldableList)(s.value0)(w);if(s instanceof F)return c["void"](k.functorEff)(g.withContext(a)(function(){g.scale(s.value0)(a)();
return w(s.value1)()}));if(s instanceof G)return c["void"](k.functorEff)(g.withContext(a)(function(){g.translate(s.value0)(a)();return w(s.value1)()}));if(s instanceof v)return c["void"](k.functorEff)(g.withContext(a)(function(){g.rotate(s.value0)(a)();return w(s.value1)()}));if(s instanceof z)return c["void"](k.functorEff)(g.withContext(a)(function(){L(s.value0)();g.clip(a)();return w(s.value1)()}));if(s instanceof H)return c["void"](k.functorEff)(g.withContext(a)(function(){d(s.value0)();return w(s.value1)()}));
throw Error("Failed pattern match at Graphics.Drawing line 199, column 1 - line 200, column 1: "+[s.constructor.name]);},L=function(){var d=function(f){if(f instanceof u&&f.value1 instanceof b.Cons)return function(){g.moveTo(a)(f.value1.value0.x)(f.value1.value0.y)();e.for_(k.applicativeEff)(b.foldableList)(f.value1.value1)(function(b){return g.lineTo(a)(b.x)(b.y)})();return m.when(k.monadEff)(f.value0)(c["void"](k.functorEff)(g.closePath(a)))()};if(f instanceof t)return c["void"](k.functorEff)(g.rect(a)(f.value0));
if(f instanceof p)return c["void"](k.functorEff)(g.arc(a)({x:f.value0.x,y:f.value0.y,r:f.value0.r,start:0,end:2*q.pi}));if(f instanceof x)return e.for_(k.applicativeEff)(b.foldableList)(f.value0)(d);throw Error("Failed pattern match at Graphics.Drawing line 199, column 1 - line 200, column 1: "+[f.constructor.name]);};return d}();return w};a.rotate=E;a.translate=function(a){return function(b){return G.create({translateX:a,translateY:b})}};a.scale=function(a){return function(b){return F.create({scaleX:a,
scaleY:b})}};a.outlined=I;a.filled=K;a.shadow=w;a.shadowColor=function(a){return{color:new h.Just(a),blur:h.Nothing.value,offset:h.Nothing.value}};a.shadowBlur=function(a){return{color:h.Nothing.value,blur:new h.Just(a),offset:h.Nothing.value}};a.lineWidth=function(a){return{color:h.Nothing.value,lineWidth:new h.Just(a)}};a.outlineColor=function(a){return{color:new h.Just(a),lineWidth:h.Nothing.value}};a.fillColor=function(a){return{color:new h.Just(a)}};a.circle=function(a){return function(b){return function(c){return new p({x:a,
y:b,r:c})}}};a.rectangle=function(a){return function(b){return function(c){return function(d){return new t({x:a,y:b,w:c,h:d})}}}};a.path=function(a){return c["<<<"](c.semigroupoidFn)(u.create(!1))(b.toList(a))};a.semigroupShape=A;a.semigroupShadow=D;a.semigroupDrawing=B;a.monoidDrawing=d})(PS["Graphics.Drawing"]=PS["Graphics.Drawing"]||{});
(function(a){a.onSpaceBar=function(a){return function(){window.addEventListener("keydown",function(b){32===b.keyCode&&a(!0)()},!1);window.addEventListener("keyup",function(b){32===b.keyCode&&a(!1)()},!1)}};a.onSpaceBarOnce=function(a){return function(){var b=function(d){32===d.keyCode&&a();window.removeEventListener("keydown",b)};window.addEventListener("keydown",b)}}})(PS.Main=PS.Main||{});
(function(a){var c=PS.Main,b=PS.Prelude,d=PS.Math,f=PS["Data.Int"],g=PS["Control.Monad.Eff"],e=PS["Control.Monad.Eff.Unsafe"],n=PS["Data.Traversable"],m=PS["Data.List"],q=PS["Control.Monad.Eff.Random"],h=PS["Data.List.Lazy"],k=PS["Graphics.Canvas"],u=PS["Control.Monad.Eff.Ref"],t=PS["Data.Maybe.Unsafe"],p=PS["Data.Foldable"],x=PS["Control.MonadPlus"],r=PS["Graphics.Drawing.Color"],l=PS["Graphics.Drawing"],y=PS["Data.Monoid"],F=PS["Data.Date"],G=PS["DOM.RequestAnimationFrame"],v=PS["Data.Maybe"],z=
PS["Data.Tuple"],H=PS["Data.Time"],w=function(){function a(){}a.value=new a;return a}(),A=function(){function a(){}a.value=new a;return a}(),D=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),B=function(){function a(b){this.value0=b}a.create=function(b){return new a(b)};return a}(),E=function(a){return function(b){return{x:a.x-b.x,y:a.y-b.y}}},I=function(a){return a.x*a.x+a.y*a.y},K=new b.Eq(function(a){return function(b){return a instanceof w&&b instanceof
w||a instanceof A&&b instanceof A?!0:!1}}),M=function(a){return function(b){return I(E(b)(a))}},C=function(a){return function(b){return function(c){return(1-d.exp(-f.toNumber(c)/2.5))*(b-a)+a}}},J=function(a){return b["<<<"](b.semigroupoidFn)(g.runPure)(e.unsafeInterleaveEff)(function(){var c=C(0.09)(0.12)(a),d=C(3)(15)(a),e=C(100)(20)(a),h=C(15)(25)(a);return function(){var a=n["for"](g.applicativeEff)(m.traversableList)(b["<*>"](m.applyList)(b["<$>"](m.functorList)(z.Tuple.create)(m[".."](0)(8)))(m[".."](0)(4)))(function(a){return function(){var c=
q.randomRange(-h)(h)(),e=q.randomRange(-h)(h)();return b["return"](g.applicativeEff)({x:100+70*f.toNumber(a.value0)+c,y:100+70*f.toNumber(a.value1)+e,r:d})()}})(),k=q.randomRange(50+e/2)(450-e/2)(),l=q.randomRange(50+e/2)(450-e/2)();return b["return"](g.applicativeEff)({stars:a,door:e,speed:c,entry:k,exit:l})()}}())},N=b["<$>"](h.functorList)(J)(h.iterate(b["+"](b.semiringInt)(1))(0)),O=function(a){return function(c){return function(d){if(b[">"](a)(c)(d))return d;if(b.otherwise)return c;throw Error("Failed pattern match at Main line 87, column 1 - line 88, column 1: "+
[c.constructor.name,d.constructor.name]);}}};a.Playing=D;a.Waiting=B;a.Up=w;a.Down=A;a.main=function(){var a=k.getCanvasElementById("canvas")();if(a instanceof v.Just){var d=k.getContext2D(a.value0)(),e=u.newRef({space:!1})();c.onSpaceBar(function(a){return u.modifyRef(e)(function(b){var c={},d;for(d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);c.space=a;return c})})();var f=function(a){return function(c){if(c instanceof m.Cons&&c.value1 instanceof m.Cons){if(50>=c.value0.y||450<=c.value0.y||750<c.value0.x&&
(c.value0.y<a.exit-a.door/2||c.value0.y>a.exit+a.door/2)||p.any(m.foldableList)(b.booleanAlgebraBoolean)(function(a){return M(c.value0)(a)<a.r*a.r})(a.stars))return!0;if(b.otherwise)return!1}throw Error("Failed pattern match at Main line 209, column 7 - line 210, column 7: "+[a.constructor.name,c.constructor.name]);}},n=function(a){return function(b){return function(c){if(c.space)c=w.value;else{if(c.space)throw Error("Failed pattern match at Main line 114, column 1 - line 227, column 28: "+[c.space.constructor.name]);
c=A.value}return new D({path:a,level:b,direction:c})}}},q=function(a){return function(c){return function(d){return function(e){var f;if(d)f=1;else{if(d)throw Error("Failed pattern match at Main line 163, column 13 - line 166, column 9: "+[d.constructor.name]);f=-1}e=O(b.ordNumber)(e)(50);var g={x:c.x+a.speed*e,y:c.y+f*a.speed*e};return b.bind(v.bindMaybe)(x.guard(v.monadPlusMaybe)(750>g.x||g.y<a.exit-a.door/2||g.y>a.exit+a.door/2))(function(){return b["return"](v.applicativeMaybe)(g)})}}}},z=r.lighten(0.7)(r.green),
C=function(a){return b.not(b.booleanAlgebraFn(b.booleanAlgebraBoolean))(m["null"])(a)?l.outlined(l.outlineColor(z))(l.path(m.foldableList)(a)):y.mempty(l.monoidDrawing)},E=function(a){return new B({path:m.Nil.value,nextLevel:a})},I=function(a){return function(c){return function(d){if(d instanceof D&&d.value0.path instanceof m.Cons){if(f(t.fromJust(h.head(d.value0.level)))(d.value0.path))return v.Just.create(new B({path:d.value0.path,nextLevel:d.value0.level}));if(b["=="](b.eqBoolean)(b["=="](K)(d.value0.direction)(w.value))(a.space)){var e=
q(t.fromJust(h.head(d.value0.level)))(d.value0.path.value0)(a.space)(c);if(e instanceof v.Just)return v.Just.create(n(new m.Cons(e.value0,d.value0.path.value1))(d.value0.level)(a));if(e instanceof v.Nothing)return v.Just.create(E(t.fromJust(h.tail(d.value0.level))));throw Error("Failed pattern match at Main line 114, column 1 - line 227, column 28: "+[e.constructor.name]);}if(b.otherwise)return v.Just.create(n(new m.Cons(d.value0.path.value0,new m.Cons(d.value0.path.value0,d.value0.path.value1)))(d.value0.level)(a))}if(d instanceof
B){if(a.space){e=v.Just;d=d.value0.nextLevel;var g={x:50,y:t.fromJust(h.head(d)).entry};d=new D({path:m.toList(p.foldableArray)([g,g]),direction:A.value,level:d});return new e(d)}if(!a.space)return v.Nothing.value;throw Error("Failed pattern match at Main line 114, column 1 - line 227, column 28: "+[a.space.constructor.name]);}throw Error("Failed pattern match at Main line 114, column 1 - line 227, column 28: "+[a.constructor.name,c.constructor.name,d.constructor.name]);}}},J=b["void"](g.functorEff)(function(){k.setFillStyle("#1B1C1B")(d)();
return k.fillRect(d)({x:0,y:0,w:800,h:500})()}),P=function(a){a=t.fromJust(h.head(a));return p.fold(p.foldableArray)(l.monoidDrawing)([l.outlined(l.outlineColor(z))(b["<>"](l.semigroupShape)(l.rectangle(50)(50)(700)(400))(l.rectangle(45)(45)(710)(410))),l.filled(l.fillColor(z))(b["<>"](l.semigroupShape)(l.rectangle(45)(a.entry-a.door/2)(5)(a.door))(l.rectangle(750)(a.exit-a.door/2)(5)(a.door))),l.shadow(b["<>"](l.semigroupShadow)(l.shadowColor(r.white))(l.shadowBlur(4)))(p.foldMap(m.foldableList)(l.monoidDrawing)(function(a){return l.outlined(l.outlineColor(z))(l.circle(a.x)(a.y)(a.r))})(a.stars))])},
Q=function(a){if(a instanceof B)return p.fold(p.foldableArray)(l.monoidDrawing)([P(a.value0.nextLevel),C(a.value0.path)]);if(a instanceof D)return p.fold(p.foldableArray)(l.monoidDrawing)([P(a.value0.level),C(a.value0.path)]);throw Error("Failed pattern match at Main line 114, column 1 - line 227, column 28: "+[a.constructor.name]);};return function(a){var f=function(a){return function(){var g=F.nowEpochMilliseconds(),h=u.readRef(e)();return G.requestAnimationFrame(function(){var e=F.nowEpochMilliseconds();
return function(){var k=I(h)(b["-"](H.ringMilliseconds)(e)(g))(a);if(k instanceof v.Just)return function(){J();l.render(d)(Q(k.value0))();return f(k.value0)()};if(k instanceof v.Nothing)return c.onSpaceBarOnce(f(a));throw Error("Failed pattern match at Main line 114, column 1 - line 227, column 28: "+[k.constructor.name]);}()()})()}};return function(){J();l.render(d)(Q(a))();return f(a)()}}(E(N))()}throw Error("Failed pattern match at Main line 114, column 1 - line 227, column 28: "+[a.constructor.name]);
};a.levels=N;a.unsafeLevel=J;a.clamp=O;a.decay=C;a.subtract=E;a.len2=I;a.dist2=M;a.eqDirection=K;a.onSpaceBarOnce=c.onSpaceBarOnce;a.onSpaceBar=c.onSpaceBar})(PS.Main=PS.Main||{});
